/*
 zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License  zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */
var IS_CONCAT_BUILD=!0,BUILD_LMV_WORKER_URL="lmvworker.min.js",LMV_WORKER_URL=BUILD_LMV_WORKER_URL,ENABLE_DEBUG=!1,ENABLE_TRACE=!1,ENABLE_INLINE_WORKER=!0;AutodeskNamespace=function(a){var b=this;a=a.split(".");for(var c=0;c<a.length;++c)b[a[c]]=b[a[c]]||{},b=b[a[c]];return b};var _isIE11=!!navigator.userAgent.match(/Trident\/7\./);
"undefined"!==typeof window&&_isIE11&&function(){function a(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(a,c.bubbles,c.cancelable,c.detail);return d}a.prototype=window.CustomEvent.prototype;window.CustomEvent=a}();
ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){!b||b>this.byteLength?b=this.byteLength:0>b&&(b=this.byteLength+b,0>b&&(b=0));0>a&&(a=this.byteLength+a,0>a&&(a=0));if(b<=a)return new ArrayBuffer;for(var c=b-a,d=new Uint8Array(this,a,c),e=new Uint8Array(c),f=0;f<c;f++)e[f]=d[f];return e.buffer});"undefined"!==typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);
function launchFullscreen(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}
function inFullscreen(){return document.fullscreenEnabled||document.mozFullScreenElement||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1}function fullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function isFullscreenAvailable(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen}
function getAndroidVersion(a){a=a||navigator.userAgent;return(a=a.match(/Android\s([0-9\.]*)/))?a[1]:!1}function isTouchDevice(){return"ontouchstart"in window}function isIOSDevice(){return/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())}function isAndroidDevice(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")}function isMobileDevice(){return isIOSDevice()||isAndroidDevice()}
function detectWebGL(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,d=0;4>d;d++)try{if((c=a.getContext(b[d]))&&"function"===typeof c.getParameter)return 1}catch(e){}return 0}return-1}function touchStartToClick(a){a.preventDefault();a.stopPropagation();a.target.click()}(function(){var a="undefined"!==typeof window&&null!==window?window:self;a.performance||(a.performance=Date)})();
LmvMatrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};
LmvMatrix4.prototype={constructor:LmvMatrix4,set:function(a,b,c,d,e,f,g,h,k,m,n,q,r,l,u,t){var p=this.elements;p[0]=a;p[4]=b;p[8]=c;p[12]=d;p[1]=e;p[5]=f;p[9]=g;p[13]=h;p[2]=k;p[6]=m;p[10]=n;p[14]=q;p[3]=r;p[7]=l;p[11]=u;p[15]=t;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,k=e+e;a=c*g;var m=c*h,c=c*k,n=
d*h,d=d*k,e=e*k,g=f*g,h=f*h,f=f*k;b[0]=1-(n+e);b[4]=m-f;b[8]=c+h;b[1]=m+f;b[5]=1-(a+e);b[9]=d-g;b[2]=c-h;b[6]=d+g;b[10]=1-(a+n);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},multiply:function(a){return this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],k=c[12],m=c[1],n=c[5],q=c[9],r=c[13],l=c[2],u=c[6],t=c[10],p=c[14],y=c[3],z=c[7],C=c[11],c=c[15],w=d[0],B=d[4],J=d[8],K=d[12],H=d[1],G=d[5],D=d[9],v=
d[13],E=d[2],F=d[6],I=d[10],A=d[14],x=d[3],M=d[7],N=d[11],d=d[15];e[0]=f*w+g*H+h*E+k*x;e[4]=f*B+g*G+h*F+k*M;e[8]=f*J+g*D+h*I+k*N;e[12]=f*K+g*v+h*A+k*d;e[1]=m*w+n*H+q*E+r*x;e[5]=m*B+n*G+q*F+r*M;e[9]=m*J+n*D+q*I+r*N;e[13]=m*K+n*v+q*A+r*d;e[2]=l*w+u*H+t*E+p*x;e[6]=l*B+u*G+t*F+p*M;e[10]=l*J+u*D+t*I+p*N;e[14]=l*K+u*v+t*A+p*d;e[3]=y*w+z*H+C*E+c*x;e[7]=y*B+z*G+C*F+c*M;e[11]=y*J+z*D+C*I+c*N;e[15]=y*K+z*v+C*A+c*d;return this},multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=
d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],m=a[2],n=a[6],q=a[10],r=a[14];
return a[3]*(+e*h*n-d*k*n-e*g*q+c*k*q+d*g*r-c*h*r)+a[7]*(+b*h*r-b*k*q+e*f*q-d*f*r+d*k*m-e*h*m)+a[11]*(+b*k*n-b*g*r-e*f*n+c*f*r+e*g*m-c*k*m)+a[15]*(-d*g*m-b*h*n+b*g*q+d*f*n-c*f*q+c*h*m)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=
c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],k=d[1],m=d[5],n=d[9],q=d[13],r=d[2],l=d[6],u=d[10],t=d[14],p=d[3],y=d[7],z=d[11],d=d[15];c[0]=n*t*y-q*u*y+q*l*z-m*t*z-n*l*d+m*u*d;c[4]=h*u*y-g*t*y-h*l*z+f*t*z+g*l*d-f*u*
d;c[8]=g*q*y-h*n*y+h*m*z-f*q*z-g*m*d+f*n*d;c[12]=h*n*l-g*q*l-h*m*u+f*q*u+g*m*t-f*n*t;c[1]=q*u*p-n*t*p-q*r*z+k*t*z+n*r*d-k*u*d;c[5]=g*t*p-h*u*p+h*r*z-e*t*z-g*r*d+e*u*d;c[9]=h*n*p-g*q*p-h*k*z+e*q*z+g*k*d-e*n*d;c[13]=g*q*r-h*n*r+h*k*u-e*q*u-g*k*t+e*n*t;c[2]=m*t*p-q*l*p+q*r*y-k*t*y-m*r*d+k*l*d;c[6]=h*l*p-f*t*p-h*r*y+e*t*y+f*r*d-e*l*d;c[10]=f*q*p-h*m*p+h*k*y-e*q*y-f*k*d+e*m*d;c[14]=h*m*r-f*q*r-h*k*l+e*q*l+f*k*t-e*m*t;c[3]=n*l*p-m*u*p-n*r*y+k*u*y+m*r*z-k*l*z;c[7]=f*u*p-g*l*p+g*r*y-e*u*y-f*r*z+e*l*z;c[11]=
g*m*p-f*n*p-g*k*y+e*n*y+f*k*z-e*m*z;c[15]=f*n*r-g*m*r+g*k*l-e*n*l-f*k*u+e*m*u;c=e*c[0]+k*c[4]+r*c[8]+p*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},
makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,
g=a.y,h=a.z,k=e*f,m=e*g;this.set(k*f+c,k*g-d*h,k*h+d*g,0,k*g+d*h,m*g+c,m*h-d*f,0,k*h-d*g,m*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},transformPoint:function(a){var b=a.x,c=a.y,d=a.z,e=this.elements;a.x=e[0]*b+e[4]*c+e[8]*d+e[12];a.y=e[1]*b+e[5]*c+e[9]*d+e[13];a.z=e[2]*b+e[6]*c+e[10]*d+e[14];return a},transformDirection:function(a){var b=
a.x,c=a.y,d=a.z,e=this.elements;a.x=e[0]*b+e[4]*c+e[8]*d;a.y=e[1]*b+e[5]*c+e[9]*d;a.z=e[2]*b+e[6]*c+e[10]*d;b=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);0<b&&(b=1/b,a.x*=b,a.y*=b,a.z*=b);return a},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return(new LmvMatrix4).fromArray(this.elements)}};
(function(){function a(a){throw a;}function b(a,b){var c=a.split("."),d=n;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function c(a,b,c){var d="number"===typeof b?b:b=0,e="number"===typeof c?c:a.length;c=-1;for(d=e&7;d--;++b)c=c>>>8^t[(c^a[b])&255];for(d=e>>3;d--;b+=8)c=c>>>8^t[(c^a[b])&255],c=c>>>8^t[(c^a[b+1])&255],c=c>>>8^t[(c^a[b+2])&255],c=c>>>8^t[(c^a[b+3])&255],c=c>>>8^t[(c^a[b+4])&255],c=c>>>8^t[(c^a[b+
5])&255],c=c>>>8^t[(c^a[b+6])&255],c=c>>>8^t[(c^a[b+7])&255];return(c^4294967295)>>>0}function d(){}function e(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,p,k,n,l,m;for(l=0;l<b;++l)a[l]>c&&(c=a[l]),a[l]<d&&(d=a[l]);e=1<<c;f=new (q?Uint32Array:Array)(e);g=1;h=0;for(p=2;g<=c;){for(l=0;l<b;++l)if(a[l]===g){k=0;n=h;for(m=0;m<g;++m)k=k<<1|n&1,n>>=1;for(m=k;m<e;m+=p)f[m]=g<<16|l;++h}++g;h<<=1;p<<=1}return[f,c,d]}function f(b,c){this.i=[];this.j=32768;this.d=this.f=this.c=this.n=0;this.input=
q?new Uint8Array(b):b;this.o=!1;this.k=y;this.w=!1;if(c||!(c={}))c.index&&(this.c=c.index),c.bufferSize&&(this.j=c.bufferSize),c.bufferType&&(this.k=c.bufferType),c.resize&&(this.w=c.resize);switch(this.k){case p:this.a=32768;this.b=new (q?Uint8Array:Array)(32768+this.j+258);break;case y:this.a=0;this.b=new (q?Uint8Array:Array)(this.j);this.e=this.D;this.q=this.A;this.l=this.C;break;default:a(Error("invalid inflate mode"))}}function g(b,c){for(var d=b.f,e=b.d,f=b.input,g=b.c,h;e<c;)h=f[g++],void 0===
h&&a(Error("input buffer is broken")),d|=h<<e,e+=8;b.f=d>>>c;b.d=e-c;b.c=g;return d&(1<<c)-1}function h(a,b){for(var c=a.f,d=a.d,e=a.input,f=a.c,g=b[0],h=b[1],p;d<h;){p=e[f++];if(void 0===p)break;c|=p<<d;d+=8}e=g[c&(1<<h)-1];g=e>>>16;a.f=c>>g;a.d=d-g;a.c=f;return e&65535}function k(a){function b(a,c,d){var e,f,A,p;for(p=0;p<a;)switch(e=h(this,c),e){case 16:for(A=3+g(this,2);A--;)d[p++]=f;break;case 17:for(A=3+g(this,3);A--;)d[p++]=0;f=0;break;case 18:for(A=11+g(this,7);A--;)d[p++]=0;f=0;break;default:f=
d[p++]=e}return d}var c=g(a,5)+257,d=g(a,5)+1,f=g(a,4)+4,p=new (q?Uint8Array:Array)(z.length),A;for(A=0;A<f;++A)p[z[A]]=g(a,3);f=e(p);p=new (q?Uint8Array:Array)(c);A=new (q?Uint8Array:Array)(d);a.l(e(b.call(a,c,f,p)),e(b.call(a,d,f,A)))}function m(a){this.input=a;this.c=0;this.m=[];this.s=!1}var n=this,q="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (q?Uint8Array:Array)(256);var r;for(r=0;256>r;++r)for(var l=r,u=7,l=l>>>1;l;l>>>=1)--u;r=[0,
1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,
651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,
4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,
167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,
3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,
2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var t=q?new Uint32Array(r):r;d.prototype.getName=function(){return this.name};d.prototype.getData=function(){return this.data};d.prototype.G=function(){return this.H};b("Zlib.GunzipMember",d);b("Zlib.GunzipMember.prototype.getName",d.prototype.getName);b("Zlib.GunzipMember.prototype.getData",
d.prototype.getData);b("Zlib.GunzipMember.prototype.getMtime",d.prototype.G);r=[];for(l=0;288>l;l++)switch(!0){case 143>=l:r.push([l+48,8]);break;case 255>=l:r.push([l-144+400,9]);break;case 279>=l:r.push([l-256+0,7]);break;case 287>=l:r.push([l-280+192,8]);break;default:a("invalid literal: "+l)}r=function(){function b(c){switch(!0){case 3===c:return[257,c-3,0];case 4===c:return[258,c-4,0];case 5===c:return[259,c-5,0];case 6===c:return[260,c-6,0];case 7===c:return[261,c-7,0];case 8===c:return[262,
c-8,0];case 9===c:return[263,c-9,0];case 10===c:return[264,c-10,0];case 12>=c:return[265,c-11,1];case 14>=c:return[266,c-13,1];case 16>=c:return[267,c-15,1];case 18>=c:return[268,c-17,1];case 22>=c:return[269,c-19,2];case 26>=c:return[270,c-23,2];case 30>=c:return[271,c-27,2];case 34>=c:return[272,c-31,2];case 42>=c:return[273,c-35,3];case 50>=c:return[274,c-43,3];case 58>=c:return[275,c-51,3];case 66>=c:return[276,c-59,3];case 82>=c:return[277,c-67,4];case 98>=c:return[278,c-83,4];case 114>=c:return[279,
c-99,4];case 130>=c:return[280,c-115,4];case 162>=c:return[281,c-131,5];case 194>=c:return[282,c-163,5];case 226>=c:return[283,c-195,5];case 257>=c:return[284,c-227,5];case 258===c:return[285,c-258,0];default:a("invalid length: "+c)}}var c=[],d,e;for(d=3;258>=d;d++)e=b(d),c[d]=e[2]<<24|e[1]<<16|e[0];return c}();q&&new Uint32Array(r);var p=0,y=1;f.prototype.g=function(){for(;!this.o;){var b=g(this,3);b&1&&(this.o=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,d=this.b,e=this.a,f=void 0,h=void 0,
A=void 0,x=d.length,f=void 0;this.d=this.f=0;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: LEN (first byte)"));h=f;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: LEN (second byte)"));h|=f<<8;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: NLEN (first byte)"));A=f;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: NLEN (second byte)"));A|=f<<8;h===~A&&a(Error("invalid uncompressed block header: length verify"));c+h>b.length&&a(Error("input buffer is broken"));
switch(this.k){case p:for(;e+h>d.length;){f=x-e;h-=f;if(q)d.set(b.subarray(c,c+f),e),e+=f,c+=f;else for(;f--;)d[e++]=b[c++];this.a=e;d=this.e();e=this.a}break;case y:for(;e+h>d.length;)d=this.e({t:2});break;default:a(Error("invalid inflate mode"))}if(q)d.set(b.subarray(c,c+h),e),e+=h,c+=h;else for(;h--;)d[e++]=b[c++];this.c=c;this.a=e;this.b=d;break;case 1:this.l(K,H);break;case 2:k(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.q()};r=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,
15];var z=q?new Uint16Array(r):r;r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var C=q?new Uint16Array(r):r;r=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var w=q?new Uint8Array(r):r;r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var B=q?new Uint16Array(r):r;r=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var J=q?new Uint8Array(r):r;r=
new (q?Uint8Array:Array)(288);l=0;for(u=r.length;l<u;++l)r[l]=143>=l?8:255>=l?9:279>=l?7:8;var K=e(r);r=new (q?Uint8Array:Array)(30);l=0;for(u=r.length;l<u;++l)r[l]=5;var H=e(r);f.prototype.l=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length-258,f,A,x;256!==(f=h(this,a));)if(256>f)d>=e&&(this.a=d,c=this.e(),d=this.a),c[d++]=f;else for(f-=257,x=C[f],0<w[f]&&(x+=g(this,w[f])),f=h(this,b),A=B[f],0<J[f]&&(A+=g(this,J[f])),d>=e&&(this.a=d,c=this.e(),d=this.a);x--;)c[d]=c[d++-A];for(;8<=this.d;)this.d-=
8,this.c--;this.a=d};f.prototype.C=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length,f,A,x;256!==(f=h(this,a));)if(256>f)d>=e&&(c=this.e(),e=c.length),c[d++]=f;else for(f-=257,x=C[f],0<w[f]&&(x+=g(this,w[f])),f=h(this,b),A=B[f],0<J[f]&&(A+=g(this,J[f])),d+x>e&&(c=this.e(),e=c.length);x--;)c[d]=c[d++-A];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};f.prototype.e=function(){var a=new (q?Uint8Array:Array)(this.a-32768),b=this.a-32768,c,d,e=this.b;if(q)a.set(e.subarray(32768,a.length));else for(c=
0,d=a.length;c<d;++c)a[c]=e[c+32768];this.i.push(a);this.n+=a.length;if(q)e.set(e.subarray(b,b+32768));else for(c=0;32768>c;++c)e[c]=e[b+c];this.a=32768;return e};f.prototype.D=function(a){var b,c=this.input.length/this.c+1|0,d,e,f,g=this.input,h=this.b;a&&("number"===typeof a.t&&(c=a.t),"number"===typeof a.z&&(c+=a.z));2>c?(d=(g.length-this.c)/this.r[2],f=d/2*258|0,e=f<h.length?h.length+f:h.length<<1):e=h.length*c;q?(b=new Uint8Array(e),b.set(h)):b=h;return this.b=b};f.prototype.q=function(){var a=
0,b=this.b,c=this.i,d,e=new (q?Uint8Array:Array)(this.n+(this.a-32768)),f,g,h,p;if(0===c.length)return q?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);f=0;for(g=c.length;f<g;++f)for(d=c[f],h=0,p=d.length;h<p;++h)e[a++]=d[h];f=32768;for(g=this.a;f<g;++f)e[a++]=b[f];this.i=[];return this.buffer=e};f.prototype.A=function(){var a,b=this.a;q?this.w?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};m.prototype.F=
function(){this.s||this.g();return this.m.slice()};m.prototype.g=function(){for(var b=this.input.length;this.c<b;){var e=new d,g=void 0,h=void 0,p=void 0,l=g=p=void 0,A=void 0,g=g=void 0,x=this.input,h=this.c;e.u=x[h++];e.v=x[h++];31===e.u&&139===e.v||a(Error("invalid file signature:"+e.u+","+e.v));e.p=x[h++];switch(e.p){case 8:break;default:a(Error("unknown compression method: "+e.p))}e.h=x[h++];g=x[h++]|x[h++]<<8|x[h++]<<16|x[h++]<<24;e.H=new Date(1E3*g);e.N=x[h++];e.M=x[h++];0<(e.h&4)&&(e.I=x[h++]|
x[h++]<<8,h+=e.I);if(0<(e.h&8)){A=[];for(l=0;0<(g=x[h++]);)A[l++]=String.fromCharCode(g);e.name=A.join("")}if(0<(e.h&16)){A=[];for(l=0;0<(g=x[h++]);)A[l++]=String.fromCharCode(g);e.J=A.join("")}0<(e.h&2)&&(e.B=c(x,0,h)&65535,e.B!==(x[h++]|x[h++]<<8)&&a(Error("invalid header crc16")));g=x[x.length-4]|x[x.length-3]<<8|x[x.length-2]<<16|x[x.length-1]<<24;x.length-h-4-4<512*g&&(p=g);h=new f(x,{index:h,bufferSize:p});e.data=p=h.g();h=h.c;e.K=g=(x[h++]|x[h++]<<8|x[h++]<<16|x[h++]<<24)>>>0;c(p,void 0,void 0)!==
g&&a(Error("invalid CRC-32 checksum: 0x"+c(p,void 0,void 0).toString(16)+" / 0x"+g.toString(16)));e.L=g=(x[h++]|x[h++]<<8|x[h++]<<16|x[h++]<<24)>>>0;(p.length&4294967295)!==g&&a(Error("invalid input size: "+(p.length&4294967295)+" / "+g));this.m.push(e);this.c=h}this.s=!0;b=this.m;e=p=h=0;for(x=b.length;e<x;++e)p+=b[e].data.length;if(q)for(p=new Uint8Array(p),e=0;e<x;++e)p.set(b[e].data,h),h+=b[e].data.length;else{p=[];for(e=0;e<x;++e)p[e]=b[e].data;p=Array.prototype.concat.apply([],p)}return p};
b("Zlib.Gunzip",m);b("Zlib.Gunzip.prototype.decompress",m.prototype.g);b("Zlib.Gunzip.prototype.getMembers",m.prototype.F)}).call(this);
(function(){function a(a){throw a;}function b(a,b){var c=a.split("."),d=u;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function c(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,h,g,p,l,k,n,m;for(n=0;n<b;++n)a[n]>c&&(c=a[n]),a[n]<d&&(d=a[n]);e=1<<c;f=new (t?Uint32Array:Array)(e);h=1;g=0;for(p=2;h<=c;){for(n=0;n<b;++n)if(a[n]===h){l=0;k=g;for(m=0;m<h;++m)l=l<<1|k&1,k>>=1;for(m=l;m<e;m+=p)f[m]=h<<16|n;++g}++h;
g<<=1;p<<=1}return[f,c,d]}function d(b,c){this.l=[];this.m=32768;this.d=this.f=this.c=this.t=0;this.input=t?new Uint8Array(b):b;this.u=!1;this.n=w;this.K=!1;if(c||!(c={}))c.index&&(this.c=c.index),c.bufferSize&&(this.m=c.bufferSize),c.bufferType&&(this.n=c.bufferType),c.resize&&(this.K=c.resize);switch(this.n){case C:this.a=32768;this.b=new (t?Uint8Array:Array)(32768+this.m+258);break;case w:this.a=0;this.b=new (t?Uint8Array:Array)(this.m);this.e=this.W;this.B=this.R;this.q=this.V;break;default:a(Error("invalid inflate mode"))}}
function e(b,c){for(var d=b.f,e=b.d,f=b.input,h=b.c,g;e<c;)g=f[h++],void 0===g&&a(Error("input buffer is broken")),d|=g<<e,e+=8;b.f=d>>>c;b.d=e-c;b.c=h;return d&(1<<c)-1}function f(a,b){for(var c=a.f,d=a.d,e=a.input,f=a.c,h=b[0],g=b[1],p;d<g;){p=e[f++];if(void 0===p)break;c|=p<<d;d+=8}e=h[c&(1<<g)-1];h=e>>>16;a.f=c>>h;a.d=d-h;a.c=f;return e&65535}function g(a){function b(a,c,d){var h,g,p,l;for(l=0;l<a;)switch(h=f(this,c),h){case 16:for(p=3+e(this,2);p--;)d[l++]=g;break;case 17:for(p=3+e(this,3);p--;)d[l++]=
0;g=0;break;case 18:for(p=11+e(this,7);p--;)d[l++]=0;g=0;break;default:g=d[l++]=h}return d}var d=e(a,5)+257,h=e(a,5)+1,g=e(a,4)+4,p=new (t?Uint8Array:Array)(B.length),l;for(l=0;l<g;++l)p[B[l]]=e(a,3);g=c(p);p=new (t?Uint8Array:Array)(d);l=new (t?Uint8Array:Array)(h);a.q(c(b.call(a,d,g,p)),c(b.call(a,h,g,l)))}function h(a){a=a||{};this.files=[];this.v=a.comment}function k(a,b){b=b||{};this.input=t&&a instanceof Array?new Uint8Array(a):a;this.c=0;this.ba=b.verify||!1;this.j=b.password}function m(a,
b){this.input=a;this.offset=b}function n(a,b){this.input=a;this.offset=b}function q(b){var c=[],d={},e,f,h,g;if(!b.i){if(void 0===b.o){e=b.input;if(!b.D)a:{f=b.input;for(h=f.length-12;0<h;--h)if(f[h]===I[0]&&f[h+1]===I[1]&&f[h+2]===I[2]&&f[h+3]===I[3]){b.D=h;break a}a(Error("End of Central Directory Record not found"))}f=b.D;e[f++]===I[0]&&e[f++]===I[1]&&e[f++]===I[2]&&e[f++]===I[3]||a(Error("invalid signature"));b.ha=e[f++]|e[f++]<<8;b.ja=e[f++]|e[f++]<<8;b.ka=e[f++]|e[f++]<<8;b.aa=e[f++]|e[f++]<<
8;b.Q=(e[f++]|e[f++]<<8|e[f++]<<16|e[f++]<<24)>>>0;b.o=(e[f++]|e[f++]<<8|e[f++]<<16|e[f++]<<24)>>>0;b.w=e[f++]|e[f++]<<8;b.v=t?e.subarray(f,f+b.w):e.slice(f,f+b.w)}e=b.o;h=0;for(g=b.aa;h<g;++h)f=new m(b.input,e),f.parse(),e+=f.length,c[h]=f,d[f.filename]=h;b.Q<e-b.o&&a(Error("invalid file header size"));b.i=c;b.G=d}}function r(a,b,c){c^=a.s(b);a.k(b,c);return c}var l,u=this,t="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (t?Uint8Array:Array)(256);
for(l=0;256>l;++l)for(var p=l,y=7,p=p>>>1;p;p>>>=1)--y;l=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,
3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,
314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,
3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,
1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,
1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var z=t?new Uint32Array(l):l;l=[];for(p=0;288>p;p++)switch(!0){case 143>=p:l.push([p+48,8]);break;case 255>=p:l.push([p-144+400,9]);break;case 279>=p:l.push([p-256+0,7]);break;case 287>=p:l.push([p-280+192,8]);break;default:a("invalid literal: "+
p)}l=function(){function b(c){switch(!0){case 3===c:return[257,c-3,0];case 4===c:return[258,c-4,0];case 5===c:return[259,c-5,0];case 6===c:return[260,c-6,0];case 7===c:return[261,c-7,0];case 8===c:return[262,c-8,0];case 9===c:return[263,c-9,0];case 10===c:return[264,c-10,0];case 12>=c:return[265,c-11,1];case 14>=c:return[266,c-13,1];case 16>=c:return[267,c-15,1];case 18>=c:return[268,c-17,1];case 22>=c:return[269,c-19,2];case 26>=c:return[270,c-23,2];case 30>=c:return[271,c-27,2];case 34>=c:return[272,
c-31,2];case 42>=c:return[273,c-35,3];case 50>=c:return[274,c-43,3];case 58>=c:return[275,c-51,3];case 66>=c:return[276,c-59,3];case 82>=c:return[277,c-67,4];case 98>=c:return[278,c-83,4];case 114>=c:return[279,c-99,4];case 130>=c:return[280,c-115,4];case 162>=c:return[281,c-131,5];case 194>=c:return[282,c-163,5];case 226>=c:return[283,c-195,5];case 257>=c:return[284,c-227,5];case 258===c:return[285,c-258,0];default:a("invalid length: "+c)}}var c=[],d,e;for(d=3;258>=d;d++)e=b(d),c[d]=e[2]<<24|e[1]<<
16|e[0];return c}();t&&new Uint32Array(l);var C=0,w=1;d.prototype.r=function(){for(;!this.u;){var b=e(this,3);b&1&&(this.u=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,d=this.b,f=this.a,h=void 0,p=void 0,l=void 0,n=d.length,h=void 0;this.d=this.f=0;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: LEN (first byte)"));p=h;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: LEN (second byte)"));p|=h<<8;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: NLEN (first byte)"));
l=h;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: NLEN (second byte)"));l|=h<<8;p===~l&&a(Error("invalid uncompressed block header: length verify"));c+p>b.length&&a(Error("input buffer is broken"));switch(this.n){case C:for(;f+p>d.length;){h=n-f;p-=h;if(t)d.set(b.subarray(c,c+h),f),f+=h,c+=h;else for(;h--;)d[f++]=b[c++];this.a=f;d=this.e();f=this.a}break;case w:for(;f+p>d.length;)d=this.e({H:2});break;default:a(Error("invalid inflate mode"))}if(t)d.set(b.subarray(c,c+p),f),f+=p,
c+=p;else for(;p--;)d[f++]=b[c++];this.c=c;this.a=f;this.b=d;break;case 1:this.q(D,v);break;case 2:g(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.B()};l=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var B=t?new Uint16Array(l):l;l=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var J=t?new Uint16Array(l):l;l=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var K=t?new Uint8Array(l):l;l=[1,2,3,4,5,7,9,13,17,25,33,49,
65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var H=t?new Uint16Array(l):l;l=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var G=t?new Uint8Array(l):l;l=new (t?Uint8Array:Array)(288);p=0;for(y=l.length;p<y;++p)l[p]=143>=p?8:255>=p?9:279>=p?7:8;var D=c(l);l=new (t?Uint8Array:Array)(30);p=0;for(y=l.length;p<y;++p)l[p]=5;var v=c(l);l=d.prototype;l.q=function(a,b){var c=this.b,d=this.a;this.C=a;for(var h=c.length-258,g,p,l;256!==(g=f(this,
a));)if(256>g)d>=h&&(this.a=d,c=this.e(),d=this.a),c[d++]=g;else for(g-=257,l=J[g],0<K[g]&&(l+=e(this,K[g])),g=f(this,b),p=H[g],0<G[g]&&(p+=e(this,G[g])),d>=h&&(this.a=d,c=this.e(),d=this.a);l--;)c[d]=c[d++-p];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};l.V=function(a,b){var c=this.b,d=this.a;this.C=a;for(var h=c.length,g,p,l;256!==(g=f(this,a));)if(256>g)d>=h&&(c=this.e(),h=c.length),c[d++]=g;else for(g-=257,l=J[g],0<K[g]&&(l+=e(this,K[g])),g=f(this,b),p=H[g],0<G[g]&&(p+=e(this,G[g])),d+l>h&&(c=
this.e(),h=c.length);l--;)c[d]=c[d++-p];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};l.e=function(){var a=new (t?Uint8Array:Array)(this.a-32768),b=this.a-32768,c,d,e=this.b;if(t)a.set(e.subarray(32768,a.length));else for(c=0,d=a.length;c<d;++c)a[c]=e[c+32768];this.l.push(a);this.t+=a.length;if(t)e.set(e.subarray(b,b+32768));else for(c=0;32768>c;++c)e[c]=e[b+c];this.a=32768;return e};l.W=function(a){var b,c=this.input.length/this.c+1|0,d,e,f,h=this.input,g=this.b;a&&("number"===typeof a.H&&(c=a.H),
"number"===typeof a.P&&(c+=a.P));2>c?(d=(h.length-this.c)/this.C[2],f=d/2*258|0,e=f<g.length?g.length+f:g.length<<1):e=g.length*c;t?(b=new Uint8Array(e),b.set(g)):b=g;return this.b=b};l.B=function(){var a=0,b=this.b,c=this.l,d,e=new (t?Uint8Array:Array)(this.t+(this.a-32768)),f,h,g,p;if(0===c.length)return t?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);f=0;for(h=c.length;f<h;++f)for(d=c[f],g=0,p=d.length;g<p;++g)e[a++]=d[g];f=32768;for(h=this.a;f<h;++f)e[a++]=b[f];this.l=[];return this.buffer=
e};l.R=function(){var a,b=this.a;t?this.K?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};h.prototype.L=function(a){this.j=a};h.prototype.s=function(a){a=a[2]&65535|2;return a*(a^1)>>8&255};h.prototype.k=function(a,b){a[0]=(z[(a[0]^b)&255]^a[0]>>>8)>>>0;a[1]=(6681*(20173*(a[1]+(a[0]&255))>>>0)>>>0)+1>>>0;a[2]=(z[(a[2]^a[1]>>>24)&255]^a[2]>>>8)>>>0};h.prototype.T=function(a){var b=[305419896,591751049,878082192],
c,d;t&&(b=new Uint32Array(b));c=0;for(d=a.length;c<d;++c)this.k(b,a[c]&255);return b};var E=[80,75,1,2],F=[80,75,3,4],I=[80,75,5,6];m.prototype.parse=function(){var b=this.input,c=this.offset;b[c++]===E[0]&&b[c++]===E[1]&&b[c++]===E[2]&&b[c++]===E[3]||a(Error("invalid file header signature"));this.version=b[c++];this.ia=b[c++];this.Z=b[c++]|b[c++]<<8;this.I=b[c++]|b[c++]<<8;this.A=b[c++]|b[c++]<<8;this.time=b[c++]|b[c++]<<8;this.U=b[c++]|b[c++]<<8;this.p=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>
0;this.z=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.J=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.h=b[c++]|b[c++]<<8;this.g=b[c++]|b[c++]<<8;this.F=b[c++]|b[c++]<<8;this.ea=b[c++]|b[c++]<<8;this.ga=b[c++]|b[c++]<<8;this.fa=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;this.$=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.filename=String.fromCharCode.apply(null,t?b.subarray(c,c+=this.h):b.slice(c,c+=this.h));this.X=t?b.subarray(c,c+=this.g):b.slice(c,c+=this.g);this.v=t?b.subarray(c,c+this.F):
b.slice(c,c+this.F);this.length=c-this.offset};n.prototype.parse=function(){var b=this.input,c=this.offset;b[c++]===F[0]&&b[c++]===F[1]&&b[c++]===F[2]&&b[c++]===F[3]||a(Error("invalid local file header signature"));this.Z=b[c++]|b[c++]<<8;this.I=b[c++]|b[c++]<<8;this.A=b[c++]|b[c++]<<8;this.time=b[c++]|b[c++]<<8;this.U=b[c++]|b[c++]<<8;this.p=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.z=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.J=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.h=
b[c++]|b[c++]<<8;this.g=b[c++]|b[c++]<<8;this.filename=String.fromCharCode.apply(null,t?b.subarray(c,c+=this.h):b.slice(c,c+=this.h));this.X=t?b.subarray(c,c+=this.g):b.slice(c,c+=this.g);this.length=c-this.offset};l=k.prototype;l.Y=function(){var a=[],b,c,d;this.i||q(this);d=this.i;b=0;for(c=d.length;b<c;++b)a[b]=d[b].filename;return a};l.r=function(b,c){var e;this.G||q(this);e=this.G[b];void 0===e&&a(Error(b+" not found"));var f;f=c||{};var h=this.input,g=this.i,p,l,k,m;g||q(this);void 0===g[e]&&
a(Error("wrong index"));g=g[e].$;e=new n(this.input,g);e.parse();g+=e.length;p=e.z;if(0!==(e.I&1)){f.password||this.j||a(Error("please set password"));f=this.S(f.password||this.j);k=g;for(m=g+12;k<m;++k)r(this,f,h[k]);g+=12;p-=12;k=g;for(m=g+p;k<m;++k)h[k]=r(this,f,h[k])}switch(e.A){case 0:l=t?this.input.subarray(g,g+p):this.input.slice(g,g+p);break;case 8:l=(new d(this.input,{index:g,bufferSize:e.J})).r();break;default:a(Error("unknown compression type"))}if(this.ba){h=void 0;p="number"===typeof h?
h:h=0;f=l.length;g=-1;for(p=f&7;p--;++h)g=g>>>8^z[(g^l[h])&255];for(p=f>>3;p--;h+=8)g=g>>>8^z[(g^l[h])&255],g=g>>>8^z[(g^l[h+1])&255],g=g>>>8^z[(g^l[h+2])&255],g=g>>>8^z[(g^l[h+3])&255],g=g>>>8^z[(g^l[h+4])&255],g=g>>>8^z[(g^l[h+5])&255],g=g>>>8^z[(g^l[h+6])&255],g=g>>>8^z[(g^l[h+7])&255];h=(g^4294967295)>>>0;e.p!==h&&a(Error("wrong crc: file=0x"+e.p.toString(16)+", data=0x"+h.toString(16)))}return l};l.L=function(a){this.j=a};l.k=h.prototype.k;l.S=h.prototype.T;l.s=h.prototype.s;b("Zlib.Unzip",k);
b("Zlib.Unzip.prototype.decompress",k.prototype.r);b("Zlib.Unzip.prototype.getFilenames",k.prototype.Y);b("Zlib.Unzip.prototype.setPassword",k.prototype.L)}).call(this);
function InputStream(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf);this.convFloat32=new Float32Array(this.convBuf);this.convFloat64=new Float64Array(this.convBuf)}InputStream.prototype.seek=function(a){this.offset=a};
InputStream.prototype.getBytes=function(a){var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};InputStream.prototype.getVarints=function(){var a,b=0,c=0;do a=this.buffer[this.offset++],b|=(a&127)<<c,c+=7;while(a&128);return b};InputStream.prototype.getUint8=function(){return this.buffer[this.offset++]};InputStream.prototype.getUint16=function(){this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};
InputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};InputStream.prototype.getInt32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};InputStream.prototype.getUint32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};
InputStream.prototype.getFloat32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convFloat32[0]};InputStream.prototype.getFloat64=function(){for(var a=this.buffer,b=this.convUint8,c=this.offset,d=0;8>d;d++)b[d]=a[c+d];this.offset+=8;return this.convFloat64[0]};
InputStream.prototype.getString=function(a){for(var b=this.buffer,c="",d=this.offset,e=this.offset+a;d<e;d++)c+=String.fromCharCode(b[d]);this.offset+=a;var f;try{f=decodeURIComponent(escape(c))}catch(g){f=c,debug("Failed to decode string "+f)}return f};InputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};
VBUtils={deduceUVRepetition:function(a){for(var b in a.vblayout)if(0==b.indexOf("uv"))for(var c=a.vbstride,d=a.vb,e=a.vb.length/c,f=0,g=a.vblayout[b].offset;f<e;f++,g+=c){var h=d[g],k=d[g+1];if(2<h||0>h||2<k||0>k){a.vblayout[b].isPattern=!0;break}}},computeBounds3D:function(a){var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h,k,m,n,q,r=a.vbstride,l=a.vblayout.position.offset,u=a.vb,t=a.vb.length/r;h=0;for(k=l;h<t;h++,k+=r)m=u[k],n=u[k+1],q=u[k+2],b>m&&(b=m),c>n&&(c=n),d>q&&
(d=q),e<m&&(e=m),f<n&&(f=n),g<q&&(g=q);a.boundingBox={min:{x:b,y:c,z:d},max:{x:e,y:f,z:g}};b=.5*(b+e);c=.5*(c+f);d=.5*(d+g);a=a.boundingSphere={};a.center={x:b,y:c,z:d};h=g=0;for(k=l;h<t;h++,k+=r)m=u[k],n=u[k+1],q=u[k+2],m-=b,n-=c,q-=d,q=m*m+n*n+q*q,q>g&&(g=q);a.radius=Math.sqrt(g)},bboxUnion:function(a,b){b.min.x<a.min.x&&(a.min.x=b.min.x);b.min.y<a.min.y&&(a.min.y=b.min.y);b.min.z<a.min.z&&(a.min.z=b.min.z);b.max.x>a.max.x&&(a.max.x=b.max.x);b.max.y>a.max.y&&(a.max.y=b.max.y);b.max.z>a.max.z&&(a.max.z=
b.max.z)}};var VBB_LINE_SEGMENT=16,VBB_ARC_CIRCULAR=32,VBB_ARC_ELLIPTICAL=48,VBB_TEX_QUAD=64,VBB_ONE_TRIANGLE=80,VBB_INSTANCED_FLAG=0,VBB_SEG_START_RIGHT=1,VBB_SEG_START_LEFT=2,VBB_SEG_END_RIGHT=3,VBB_SEG_END_LEFT=4,TAU=2*Math.PI,VBB_COLOR_OFFSET=6,VBB_DBID_OFFSET=7,VBB_FLAGS_OFFSET=8;
function VertexBufferBuilder(a){this.useInstancing=a;this.stride=9;this.vb=new ArrayBuffer(4*this.stride*(this.useInstancing?16384:65536));this.vbf=new Float32Array(this.vb);this.vbi=new Int32Array(this.vb);this.vcount=0;this.ib=this.useInstancing?null:new Uint16Array(65536);this.icount=0;this.minx=this.miny=Infinity;this.maxx=this.maxy=-Infinity;this.dbIds={};this.numTriangleGeoms=this.numCirculars=this.numEllipticals=0}
VertexBufferBuilder.prototype.expandStride=function(){var a=this.stride;if(!(12<=a)){for(var b=this.stride+3,c=new ArrayBuffer(this.vb.byteLength/a*b),d=new Uint8Array(this.vb),e=new Uint8Array(c),f=0,g=this.vcount;f<g;f++)for(var h=f*a*4,k=f*b*4,m=0;m<4*a;m++)e[k+m]=d[h+m];this.vb=c;this.vbf=new Float32Array(c);this.vbi=new Int32Array(c);this.stride=b}};
VertexBufferBuilder.prototype.addToBounds=function(a,b){a<this.minx&&(this.minx=a);a>this.maxx&&(this.maxx=a);b<this.miny&&(this.miny=b);b>this.maxy&&(this.maxy=b)};VertexBufferBuilder.prototype.setVertexFlag=function(a,b,c,d){this.vbi[a*this.stride+VBB_FLAGS_OFFSET]=d|c|b<<16};
VertexBufferBuilder.prototype.addVertexTriangleGeom=function(a,b,c,d,e,f,g,h){for(var k=this.vcount,m=this.useInstancing?1:4,n=0;n<m;n++){var q=(k+n)*this.stride,r=this.vbf;r[q]=a;r[q+1]=b;r[q+2]=c;r[q+3]=d;r[q+4]=e;r[q+5]=f;this.vbi[q+VBB_COLOR_OFFSET]=g;this.vbi[q+VBB_DBID_OFFSET]=h;this.vcount++;this.dbIds[h]=1}return k};
VertexBufferBuilder.prototype.addVertexLine=function(a,b,c,d,e,f,g){for(var h=this.vcount,k=this.useInstancing?1:4,m=0;m<k;m++){var n=(h+m)*this.stride,q=this.vbf;q[n]=a;q[n+1]=b;q[n+2]=c;q[n+3]=d;q[n+4]=e;q[n+5]=0;this.vbi[n+VBB_COLOR_OFFSET]=f;this.vbi[n+VBB_DBID_OFFSET]=g;this.dbIds[g]=1;this.vcount++}return h};
VertexBufferBuilder.prototype.addVertexArc=function(a,b,c,d,e,f,g,h,k,m){for(var n=this.vcount,q=this.useInstancing?1:4,r=0;r<q;r++){var l=(n+r)*this.stride,u=this.vbf;u[l]=a;u[l+1]=b;u[l+2]=c;u[l+3]=d;u[l+4]=h;u[l+5]=e;this.vbi[l+VBB_COLOR_OFFSET]=k;this.vbi[l+VBB_DBID_OFFSET]=m;e!=f&&(u[l+9]=f,u[l+10]=g);this.dbIds[m]=1;this.vcount++}return n};
VertexBufferBuilder.prototype.addVertex=function(a,b,c,d,e,f,g,h){if(!this.useInstancing){var k=this.vcount,m=k*this.stride,n=this.vbf;n[m]=a;n[m+1]=b;n[m+2]=c;n[m+3]=d;n[m+4]=e;n[m+5]=0;this.vbi[m+VBB_COLOR_OFFSET]=f;this.vbi[m+VBB_DBID_OFFSET]=g;this.setVertexFlag(k,h,0,0);this.vcount++;this.dbIds[g]=1;return k}};VertexBufferBuilder.prototype.addVertexPolytriangle=function(a,b,c,d,e,f,g,h){this.useInstancing||(this.addVertex(a,b,c,d,e,f,g,h),this.addToBounds(a,b))};
VertexBufferBuilder.prototype.setVertexColor=function(a,b){this.useInstancing||(this.vbi[a*this.stride+VBB_COLOR_OFFSET]=b)};VertexBufferBuilder.prototype.addTriangle=function(a,b,c){if(!this.useInstancing){var d=this.ib,e=this.icount;if(e+3>=d.length){for(var f=new Uint16Array(2*d.length),g=0;g<e;g++)f[g]=d[g];this.ib=d=f}d[e]=a;d[e+1]=b;d[e+2]=c;this.icount+=3}};
VertexBufferBuilder.prototype.finalizeQuad=function(a,b,c){this.useInstancing?this.setVertexFlag(a,c,VBB_INSTANCED_FLAG,b):(this.addTriangle(a,a+1,a+2),this.addTriangle(a,a+2,a+3),this.setVertexFlag(a,c,VBB_SEG_START_RIGHT,b),this.setVertexFlag(a+1,c,VBB_SEG_END_RIGHT,b),this.setVertexFlag(a+2,c,VBB_SEG_END_LEFT,b),this.setVertexFlag(a+3,c,VBB_SEG_START_LEFT,b))};
VertexBufferBuilder.prototype.addSegment=function(a,b,c,d,e,f,g,h){var k=c-a,m=d-b,n=0;if(k||m)n=Math.atan2(m,k);k=Math.sqrt(k*k+m*m);e=this.addVertexLine(a,b,n,k,.5*e,f,g);this.finalizeQuad(e,VBB_LINE_SEGMENT,h);this.addToBounds(a,b);this.addToBounds(c,d)};
VertexBufferBuilder.prototype.addTriangleGeom=function(a,b,c,d,e,f,g,h,k){this.numTriangleGeoms++;g=this.addVertexTriangleGeom(a,b,c,d,e,f,g,h,k);this.finalizeQuad(g,VBB_ONE_TRIANGLE,k);this.addToBounds(a,b);this.addToBounds(c,d);this.addToBounds(e,f)};
VertexBufferBuilder.prototype.addCircularArc=function(a,b,c,d,e,f,g,h,k){this.numCirculars++;0==c&&0==d&&(d=TAU);var m=Math.abs(c-d);if(1E-4<m&&1E-4<Math.abs(m-TAU)){var m=a+e*Math.cos(c),n=b+e*Math.sin(c);this.addSegment(m,n,m,n,f,g,h,k);m=a+e*Math.cos(d);n=b+e*Math.sin(d);this.addSegment(m,n,m,n,f,g,h,k)}else this.addToBounds(a-e,b-e),this.addToBounds(a+e,b+e);a=this.addVertexArc(a,b,c,d,e,e,0,.5*f,g,h);this.finalizeQuad(a,VBB_ARC_CIRCULAR,k)};
VertexBufferBuilder.prototype.addEllipticalArc=function(a,b,c,d,e,f,g,h,k,m,n){this.expandStride();this.numEllipticals++;0==c&&0==d&&(d=TAU);var q=Math.abs(c-d);if(1E-4<Math.abs(q-TAU)){var q=a+e*Math.cos(c),r=b+f*Math.sin(c);this.addSegment(q,r,q,r,h,k,m,n);q=a+e*Math.cos(d);r=b+f*Math.sin(d);this.addSegment(q,r,q,r,h,k,m,n)}else this.addToBounds(a-e,b-f),this.addToBounds(a+e,b+f);a=this.addVertexArc(a,b,c,d,e,f,g,.5*h,k,m);this.finalizeQuad(a,VBB_ARC_ELLIPTICAL,n)};
VertexBufferBuilder.prototype.addTexturedQuad=function(a,b,c,d,e,f){var g=.5*d;e=this.addVertexLine(a,b+g,0,c,g,4278255615,e);this.finalizeQuad(e,VBB_TEX_QUAD,f);this.addToBounds(a,b);this.addToBounds(a+c,b+d)};VertexBufferBuilder.prototype.isFull=function(a){a||(a=3);return this.useInstancing?32767<4*this.vcount+a:32767<this.vcount+a};
VertexBufferBuilder.prototype.toMesh=function(){var a={};a.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4));a.vbstride=this.stride;var b=this.useInstancing?1:0;a.vblayout={fields1:{offset:0,itemSize:3,bytesPerItem:4,divisor:b},fields2:{offset:3,itemSize:3,bytesPerItem:4,divisor:b},color4b:{offset:VBB_COLOR_OFFSET,itemSize:4,bytesPerItem:1,divisor:b,normalize:!0},dbId4b:{offset:VBB_DBID_OFFSET,itemSize:4,bytesPerItem:1,divisor:b,normalize:!0},flags4b:{offset:VBB_FLAGS_OFFSET,itemSize:4,
bytesPerItem:1,divisor:b,normalize:!1}};9<this.stride&&(a.vblayout.extraParams={offset:9,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1});if(this.useInstancing){for(var c in a.vblayout)a.vblayout[c].divisor=1;a.numInstances=this.vcount;b=new Int32Array(4);b[0]=VBB_SEG_START_RIGHT;b[1]=VBB_SEG_END_RIGHT;b[2]=VBB_SEG_END_LEFT;b[3]=VBB_SEG_START_LEFT;a.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,normalize:!1,divisor:0};a.vblayout.instFlags4b.array=b.buffer;b=a.indices=new Uint16Array(6);
b[0]=0;b[1]=1;b[2]=2;b[3]=0;b[4]=2;b[5]=3}else a.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));a.dbIds=this.dbIds;b=this.maxx-this.minx;c=this.maxy-this.miny;var d=Math.max(b,c);a.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-d},max:{x:this.maxx,y:this.maxy,z:.001*d}};d=a.boundingSphere={};d.center={x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0};d.radius=.5*Math.sqrt(b*b+c*c);return a};
function PackFileReader(a){31==a[0]&&139==a[1]&&(a=(new Zlib.Gunzip(a)).decompress());a=this.stream=new InputStream(a);var b=a.getInt32();this.type=a.getString(b);this.version=a.getInt32();this.types=null;this.entryOffsets=[];a.seek(a.byteLength-8);var c=a.getUint32();this.typesOffset=a.getUint32();a.seek(this.typesOffset);var d=this.readU32V();this.types=[];for(b=0;b<d;++b)this.types.push({entryClass:this.readString(),entryType:this.readString(),version:this.readU32V()});a.seek(c);c=this.readU32V();
d=this.entryOffsets;for(b=0;b<c;++b)d.push(a.getUint32());a.seek(0)}PackFileReader.prototype.readVarint=function(){var a,b=0,c=0;do a=this.stream.getUint8(),b|=(a&127)<<c,c+=7;while(a&128);return b};PackFileReader.prototype.readU32V=PackFileReader.prototype.readVarint;PackFileReader.prototype.readU16=function(){return this.stream.getUint16()};PackFileReader.prototype.readU8=function(){return this.stream.getUint8()};PackFileReader.prototype.readString=function(){return this.stream.getString(this.readU32V())};
PackFileReader.prototype.readVector3f=function(){var a=this.stream;return{x:a.getFloat32(),y:a.getFloat32(),z:a.getFloat32()}};PackFileReader.prototype.readVector3d=function(){var a={x:0,y:0,z:0};return function(b){var c=this.stream;a.x=c.getFloat64();a.y=c.getFloat64();a.z=c.getFloat64();b&&(a.x-=b.x,a.y-=b.y,a.z-=b.z);return a}}();
PackFileReader.prototype.readQuaternionf=function(){var a={x:0,y:0,z:0,w:0};return function(){var b=this.stream;a.x=b.getFloat32();a.y=b.getFloat32();a.z=b.getFloat32();a.w=b.getFloat32();return a}}();PackFileReader.prototype.readMatrix3f=function(){var a=new LmvMatrix4;return function(b){b||(b=a);var c=this.stream;b.identity();for(var d=0;3>d;++d)for(var e=0;3>e;++e)b.elements[4*d+e]=c.getFloat32();return b}}();
PackFileReader.prototype.readTransform=function(){var a={x:1,y:1,z:1},b=new LmvMatrix4;return function(c,d,e,f){var g=this.stream;switch(g.getUint8()){case 4:b.identity();f&&(b.elements[12]-=f.x,b.elements[13]-=f.y,b.elements[14]-=f.z);break;case 0:f=this.readVector3d(f);b.makeTranslation(f.x,f.y,f.z);break;case 1:g=this.readQuaternionf();f=this.readVector3d(f);a.x=1;a.y=1;a.z=1;b.compose(f,g,a);break;case 2:var h=g.getFloat32(),g=this.readQuaternionf();f=this.readVector3d(f);a.x=h;a.y=h;a.z=h;b.compose(f,
g,a);break;case 3:this.readMatrix3f(b),f=this.readVector3d(f),b.setPosition(f)}if(void 0!==c)c=b.elements,d[e+0]=c[0],d[e+1]=c[1],d[e+2]=c[2],d[e+3]=c[4],d[e+4]=c[5],d[e+5]=c[6],d[e+6]=c[8],d[e+7]=c[9],d[e+8]=c[10],d[e+9]=c[12],d[e+10]=c[13],d[e+11]=c[14];else return(new LmvMatrix4).copy(b)}}();PackFileReader.prototype.getEntryCounts=function(){return this.entryOffsets.length};
PackFileReader.prototype.seekToEntry=function(a){var b=this.getEntryCounts();if(a>=b)return null;this.stream.seek(this.entryOffsets[a]);a=this.stream.getUint32();return a>=this.types.length?null:this.types[a]};
PackFileReader.prototype.readPathID=function(){var a=this.stream;if(2>this.version){var b=a.getUint16();if(!b)return null;a.getUint16();if(1==b)return"";for(var c=a.getUint16(),d=2;d<b;++d)c+="/"+a.getUint16()}else{b=this.readU32V();if(!b)return null;this.readU32V();if(1==b)return"";c=this.readU32V();for(d=2;d<b;++d)c+="/"+this.readU32V()}return c};
function readOpenCTM_RAW(a,b){var c=a.getString(4);if("INDX"!=c)return null;for(var d=b.vertexCount,e=b.triangleCount,f=b.indices=new Uint16Array(3*e),c=0,e=3*e;c<e;c++)f[c]=a.getInt32();c=a.getString(4);if("VERT"!=c)return null;var f=b.vbstride,e=b.vb,g;b.vblayout.normal&&2===b.vblayout.normal.itemSize&&(g=new Uint16Array(e.buffer));for(var c=0,h=b.vblayout.position.offset;c<d;c++,h+=f)e[h]=a.getFloat32(),e[h+1]=a.getFloat32(),e[h+2]=a.getFloat32();if(b.flags&1){c=a.getString(4);if("NORM"!=c)return null;
c=0;for(h=b.vblayout.normal.offset;c<d;c++,h+=f)if(g){var k=a.getFloat32(),m=a.getFloat32(),n=a.getFloat32(),k=.5*(Math.atan2(m,k)/Math.PI+1),n=.5*(n+1);g[2*h]=65535*k|0;g[2*h+1]=65535*n|0}else e[h]=a.getFloat32(),e[h+1]=a.getFloat32(),e[h+2]=a.getFloat32()}for(g=0;g<b.texMapCount;g++){c=a.getString(4);if("TEXC"!=c)return null;c={name:a.getString(a.getInt32()),file:a.getString(a.getInt32())};b.uvs.push(c);h="uv";g&&(h+=(g+1).toString());c=0;for(h=b.vblayout[h].offset;c<d;c++,h+=f)e[h]=a.getFloat32(),
e[h+1]=a.getFloat32()}for(g=0;g<b.attribMapCount;g++){c=a.getString(4);if("ATTR"!=c)return null;c={name:a.getString(a.getInt32())};if(-1!=c.name.indexOf("Color"))for(c=0,h=b.vblayout.color.offset;c<d;c++,h+=f)e[h]=a.getFloat32(),e[h+1]=a.getFloat32(),e[h+2]=a.getFloat32(),a.getFloat32();else b.attrs.push(c),a.getBytes(16*d)}}
var readOpenCTM=function(a){if("OCTM"!=a.getString(4)||5!=a.getInt32())return null;var b=a.getString(3);a.getUint8();var c={stream:null,vertices:null,indices:null,normals:null,colors:null,uvs:[],attrs:[]};c.vertexCount=a.getInt32();c.triangleCount=a.getInt32();c.texMapCount=a.getInt32();c.attribMapCount=a.getInt32();c.flags=a.getInt32();c.comment=a.getString(a.getInt32());c.vbstride=3;c.flags&1&&(c.vbstride+=1);c.vbstride+=2*(c.texMapCount||0);0<c.attribMapCount&&(c.vbstride+=3);c.vblayout={};var d=
0;c.vblayout.position={offset:d,itemSize:3};d+=3;c.flags&1&&(c.vblayout.normal={offset:d,itemSize:2,bytesPerItem:2,normalize:!0},d+=1);if(c.texMapCount)for(var e=0;e<c.texMapCount;e++){var f="uv";e&&(f+=(e+1).toString());c.vblayout[f]={offset:d,itemSize:2};d+=2}c.attribMapCount&&(c.vblayout.color={offset:d,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);return"RAW"==b?(readOpenCTM_RAW(a,c),VBUtils.deduceUVRepetition(c),VBUtils.computeBounds3D(c),c):"MG2"==b?(readOpenCTM_MG2(a,c),VBUtils.deduceUVRepetition(c),
VBUtils.computeBounds3D(c),c):null},readLines=function(a,b){var c={isLines:!0,vertices:null,indices:null,colors:null,normals:null,uvs:[],attrs:[]},d,e;1<b.version?(c.vertexCount=a.readU16(),d=a.readU16(),e=a.readU16()):(c.vertexCount=a.readU32V(),d=a.readU32V(),e=a.readU32V());var f=0!=a.stream.getUint8();c.vbstride=3;f&&(c.vbstride+=3);c.vblayout={};var g=0;c.vblayout.position={offset:g,itemSize:3};f&&(c.vblayout.color={offset:g+3,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);for(var h=
c.vb,k=c.vbstride,m=a.stream,n=0,g=c.vblayout.position.offset,q=c.vertexCount;n<q;n++,g+=k)h[g]=m.getFloat32(),h[g+1]=m.getFloat32(),h[g+2]=m.getFloat32();if(f)for(n=0,g=c.vblayout.color.offset,f=c.vertexCount;n<f;n++,g+=k)h[g]=m.getFloat32(),h[g+1]=m.getFloat32(),h[g+2]=m.getFloat32(),m.getFloat32();n=function(a){return a.buffer.slice(a.byteOffset,a.byteOffset+a.length)};1<b.version?(d=new Uint16Array(n(m.getBytes(2*d))),m=new Uint16Array(n(m.getBytes(2*e)))):(d=new Int32Array(n(m.getBytes(4*d))),
m=new Int32Array(n(m.getBytes(4*e))));c.indices=new Uint16Array(2*(m[e-1]-e+1));for(n=g=0;n+1<e;n++)for(h=m[n];h+1<m[n+1];h++)c.indices[g++]=d[h],c.indices[g++]=d[h+1];VBUtils.computeBounds3D(c);return c};function readGeometry(a,b,c){return(b=a.seekToEntry(b))?"Autodesk.CloudPlatform.OpenCTM"==b.entryType?readOpenCTM(a.stream):"Autodesk.CloudPlatform.Lines"==b.entryType?readLines(a,b):null:null}
function convertMaterials(a){var b=function(a,b){if(!a||!a.colors)return{r:1,g:0,b:0};var c=a.colors[b];if(!c)return{r:0,g:0,b:0};c=c.values;if(!c||!c.length)return{r:1,g:0,b:0};c=c[0];return{r:c.r,g:c.g,b:c.b}},c=function(a,b){if(!a||!a.scalars)return 0;var c=a.scalars[b];return c?c.values[0]:void 0},d=function(a,b){if(!a||!a.booleans)return 0;var c=a.booleans;return c?c[b]:void 0},e=a.materials.materials;a.simplemats={};for(var f in e){var g=e[f],h=g.materials,k=h[g.userassets[0]];if(k&&"SimplePhong"==
k.definition){var g=k.properties,m={};m.tag=k.tag;m.proteinType=k.proteinType;void 0===m.proteinType&&(m.proteinType=null);m.ambient=b(g,"generic_ambient");m.color=b(g,"generic_diffuse");m.specular=b(g,"generic_specular");m.emissive=b(g,"generic_emissive");var n=c(g,"generic_glossiness");n||(n=30);m.shininess=n;(n=c(g,"generic_transparency"))||(n=0);m.opacity=1-n;(n=c(g,"generic_reflectivity_at_0deg"))||(n=0);m.reflectivity=n;n=d(g,"generic_is_metal");void 0!==n&&(m.metal=n);n=d(g,"generic_backface_cull");
void 0!==n&&(m.doubleSided=!n);m.transparent=k.transparent;var k=k.textures,q;for(q in k){var n=h[k[q].connections[0]].properties,r=n.uris.unifiedbitmap_Bitmap.values[0],l=null;if(r)if("generic_diffuse"==q){if(l="map",!m.color||0==m.color.r&&0==m.color.g&&0==m.color.b)m.color={r:1,g:1,b:1}}else"generic_bump"==q?(l=d(g,"generic_bump_is_normal")?"normalMap":"bumpMap",m.bumpScale=c(g,"generic_bump_amount")):"generic_specular"==q?l="specularMap":"generic_reflection"!=q&&"generic_alpha"==q&&(l="alphaMap",
m.transparent=!0);l&&(m["uri_"+l]=r,(r=c(n,"texture_UScale"))&&(m["uscale_"+l]=r),(r=c(n,"texture_VScale"))&&(m["vscale_"+l]=r))}a.simplemats[f]=m}}}function readLightDefinition(a,b){var c=a.seekToEntry(b);if(!c||1<c.version)return null;c=a.stream;return{position:a.readVector3f(),dir:a.readVector3f(),r:c.getFloat32(),g:c.getFloat32(),b:c.getFloat32(),intensity:c.getFloat32(),spotAngle:c.getFloat32(),size:c.getFloat32(),type:c.getUint8()}}
function readCameraDefinition(a,b){var c=a.seekToEntry(b.definition);if(!c||2<c.version)return null;var d=a.stream,e={isPerspective:!d.getUint8(),position:a.readVector3f(),target:a.readVector3f(),up:a.readVector3f(),aspect:d.getFloat32(),fov:d.getFloat32()*(180/Math.PI)};2>c.version&&(d.getFloat32(),d.getFloat32());e.orthoScale=d.getFloat32();return e}var NUM_FRAGMENT_LIMITS=(isAndroidDevice()||isIOSDevice(),null);
function FragList(){this.numLoaded=this.length=0;this.mesh2frag=this.fragId2dbId=this.entityIndexes=this.packIds=this.materials=this.transforms=this.boxes=null}
function readGeometryMetadata(a,b,c){c=a.getEntryCounts();var d=a.stream;b.length=c;var e=b.fragTypes=new Uint8Array(c),f=b.primCounts=new Uint16Array(c),g=b.packIds=new Int32Array(c);b=b.entityIndexes=new Int32Array(c);for(var h=0;h<c&&a.seekToEntry(h);h++)e[h]=d.getUint8(),d.seek(d.offset+24),f[h]=d.getUint16(),g[h]=parseInt(a.readString()),b[h]=a.readU32V()}
function readFragments(a,b,c){function d(a){a*=6;for(var b=0;6>b;b++)h[a++]=g.getFloat32()}function e(a,b,c){a*=6;for(var d=0;6>d;d++)h[a++]=g.getFloat32()+b[c+d%3]}var f=a.getEntryCounts(),g=a.stream;NUM_FRAGMENT_LIMITS&&f>NUM_FRAGMENT_LIMITS&&(f=NUM_FRAGMENT_LIMITS);b.length=f;b.numLoaded=0;var h=b.boxes=new Float32Array(6*f),k=b.transforms=new Float32Array(12*f),m=b.materials=new Int32Array(f),n=b.packIds=new Int32Array(f),q=b.entityIndexes=new Int32Array(f),r=b.geomDataIndexes=new Int32Array(f),
f=b.fragId2dbId=new Int32Array(f),l=0;for(b=b.length;l<b;l++){var u=a.seekToEntry(l);if(!u)break;if(5<u.version)break;4<u.version&&a.readU8();m[l]=a.readU32V();2<u.version?r[l]=a.readU32V():(n[l]=parseInt(a.readString()),q[l]=a.readU32V());a.readTransform(l,k,12*l,c);if(3<u.version)e(l,k,12*l+9);else if(d(l),c){var t=6*l;h[t++]-=c.x;h[t++]-=c.y;h[t++]-=c.z;h[t++]-=c.x;h[t++]-=c.y;h[t++]-=c.z}1<u.version&&(f[l]=a.readU32V())}}
function filterFragments(a,b){a.length=b.length;a.numLoaded=0;for(var c=a.length,d=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],e=new Float32Array(6*c),f=new Float32Array(12*c),g=new Int32Array(c),h=new Int32Array(c),c=new Int32Array(c),k={},m=0;m<b.length;++m){for(var n=b[m],q=6*n,r=6*m,l=0;6>l;++l)e[r++]=a.boxes[q++];q=12*n;r=12*m;for(l=0;12>l;++l)f[r++]=a.transforms[q++];g[m]=a.materials[n];h[m]=a.packIds[n];c[m]=a.entityIndexes[n];l=a.packIds[n]+":"+a.entityIndexes[n];n=k[l];void 0==
n?k[l]=m:Array.isArray(n)?n.push(m):k[l]=[n,m];n=6*m;for(l=0;3>l;++l)e[n+l]<d[l]&&(d[l]=e[n+l]);for(l=3;6>l;++l)e[n+l]>d[l]&&(d[l]=e[n+l])}a.boxes=e;a.transforms=f;a.materials=g;a.packIds=h;a.entityIndexes=c;a.mesh2frag=k;return d}function readInstance(a,b,c){b=a.seekToEntry(b);if(!b||2<b.version)return null;1<b.version&&a.readU8();return{definition:a.stream.getUint32(),transform:a.readTransform(void 0,void 0,void 0,c),instanceNodePath:a.readPathID()}}
function Package(a){this.unzip=new Zlib.Unzip(a);this.fragments=this.metadata=this.simplemats=this.materials=this.manifest=null;this.geompacks=[];this.instances=[];this.cameras=[];this.lights=[];this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[]};this.animations=this.bbox=null;this.pendingRequests=0;this.globalOffset={x:0,y:0,z:0}}
Package.prototype.loadAsyncResource=function(a,b,c,d){function e(b){f.pendingRequests--;b&&(b=new Uint8Array(b),31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress()),d(b));0==f.pendingRequests&&f.postLoad(a)}if(c)d(c);else{var f=this;this.pendingRequests++;Autodesk.Viewing.Private.ViewingService.get(a.viewing_url,"items",a.basePath+b,e,a.onFailureCallback,{withCredentials:!!a.auth,responseType:"arraybuffer",asynchronous:!0,headers:a.headers,queryParams:a.queryParams})}};
Package.prototype.loadManifest=function(a){a=this.unzip.decompress("manifest.json");if(!a)return!1;var b=new InputStream(a);this.manifest=JSON.parse(b.getString(a.byteLength))};
Package.prototype.loadRemainingSvf=function(a){var b=this,c=this.unzip,d=this.manifest=a.manifest,e=d.assets,f=c.decompress("metadata.json"),g=new InputStream(f);3<f.byteLength&&0!==f[3]&&(this.metadata=JSON.parse(g.getString(f.byteLength)).metadata)&&(g=this.metadata["world bounding box"],f={x:g.minXYZ[0],y:g.minXYZ[1],z:g.minXYZ[2]},g={x:g.maxXYZ[0],y:g.maxXYZ[1],z:g.maxXYZ[2]},this.bbox={min:f,max:g},this.globalOffset={x:.5*(f.x+g.x),y:.5*(f.y+g.y),z:.5*(f.z+g.z)},f.x-=this.globalOffset.x,f.y-=
this.globalOffset.y,f.z-=this.globalOffset.z,g.x-=this.globalOffset.x,g.y-=this.globalOffset.y,g.z-=this.globalOffset.z,this.metadata.hasOwnProperty("double sided geometry")&&this.metadata["double sided geometry"].value&&(this.doubleSided=!0));this.primitiveCount=this.packFileTotalSize=0;g=d.typesets;d={};for(f=0;f<g.length;f++){var h=g[f];d[h.id]=h.types}for(f=0;f<e.length;f++){h=e[f];g=h.type;0==g.indexOf("Autodesk.CloudPlatform.")&&(g=g.substr(23));var k=h.URI,m=h.typeset?d[h.typeset]:null;0!=
k.indexOf("embed:/")&&("PackFile"==g?"Autodesk.CloudPlatform.Geometry"==(m?m[0]["class"]:null)&&(this.packFileTotalSize+=h.usize||0,this.geompacks.push({id:h.id,uri:k})):"PropertyAttributes"==g?this.propertydb.attrs.push(k):"PropertyAVs"==g?this.propertydb.avs.push(k):"PropertyIDs"==g?this.propertydb.ids.push(k):"PropertyOffsets"==g?this.propertydb.offsets.push(k):"PropertyValues"==g&&this.propertydb.values.push(k));h=h.URI;k=null;0==h.indexOf("embed:/")&&(h=h.substr(7),k=c.decompress(h));"ProteinMaterials"==
g?-1==h.indexOf("Protein")?this.loadAsyncResource(a,h,k,function(a){var c=new InputStream(a);a=a.byteLength;0<a?(b.materials=JSON.parse(c.getString(a)),convertMaterials(b)):b.materials=null}):this.loadAsyncResource(a,h,k,function(a){var c=new InputStream(a);a=a.byteLength;b.proteinMaterials=0<a?JSON.parse(c.getString(a)):null}):"FragmentList"==g?this.loadAsyncResource(a,h,k,function(a){a=new PackFileReader(a);var c=b.fragments=new FragList;readFragments(a,c,b.globalOffset)}):"GeometryMetadataList"==
g?this.loadAsyncResource(a,h,k,function(a){a=new PackFileReader(a);b.geomMetadata={};readGeometryMetadata(a,b.geomMetadata)}):"PackFile"==g?-1!=h.indexOf("CameraDefinitions.bin")?this.loadAsyncResource(a,h,k,function(a){b.camDefPack=new PackFileReader(a)}):-1!=h.indexOf("CameraList.bin")?this.loadAsyncResource(a,h,k,function(a){b.camInstPack=new PackFileReader(a)}):-1!=h.indexOf("LightDefinitions.bin")?this.loadAsyncResource(a,h,k,function(a){b.lightDefPack=new PackFileReader(a)}):-1!=h.indexOf("LightList.bin")&&
this.loadAsyncResource(a,h,k,function(a){b.lightInstPack=new PackFileReader(a)}):"Animations"==g&&this.loadAsyncResource(a,h,k,function(a){var c=new InputStream(a);a=a.byteLength;if(0<a){if(b.animations=JSON.parse(c.getString(a)),c=b.animations.animations){a=function(a,b){a[0]-=b.x;a[1]-=b.y;a[2]-=b.z};for(var d=b.globalOffset,e=(new LmvMatrix4).makeTranslation(d.x,d.y,d.z),f=(new LmvMatrix4).makeTranslation(-d.x,-d.y,-d.z),g=new LmvMatrix4,h=new LmvMatrix4,k=0;k<c.length;k++){var m=c[k];if(m.hierarchy)for(var C=
0;C<m.hierarchy.length;C++){var w=m.hierarchy[C].keys;if(w)for(var B=0;B<w.length;B++){var J=w[B].pos;if(J){var K=d,H=w[B].rot;H&&(g.makeRotationFromQuaternion({x:H[0],y:H[1],z:H[2],w:H[3]}),h.multiplyMatrices(e,g).multiply(f),K={x:h.elements[12],y:h.elements[13],z:h.elements[14]});a(J,K)}(J=w[B].target)&&a(J,d);if(J=w[B].points)for(K=0;K<J.length;K++)a(J[K],d)}}}}}else b.animations=null})}0==this.pendingRequests&&this.postLoad(a);delete this.unzip};
Package.prototype.postLoad=function(a){if(this.camDefPack&&this.camInstPack){for(var b=0,c=this.camInstPack.getEntryCounts();b<c;b++){var d=readInstance(this.camInstPack,b,this.globalOffset),e=readCameraDefinition(this.camDefPack,d);d.transform&&(d.transform.transformPoint(e.position),d.transform.transformPoint(e.target),d.transform.transformDirection(e.up));this.cameras.push(e)}delete this.camDefPack;delete this.camInstPack}if(this.lightDefPack&&this.lightInstPack){b=0;for(c=this.lightInstPack.getEntryCounts();b<
c;b++)d=readInstance(this.lightInstPack,b),this.lights.push(readLightDefinition(this.lightDefPack,d.definition));delete this.lightInstPack;delete this.lightDefPack}d=this.fragments;if(this.geomMetadata){d.polygonCounts=d.geomDataIndexes;c=this.geomMetadata;b=0;for(e=d.length;b<e;b++){var f=d.geomDataIndexes[b];d.entityIndexes[b]=c.entityIndexes[f];d.packIds[b]=c.packIds[f];d.polygonCounts[b]=c.primCounts[f];this.primitiveCount+=c.primCounts[f]}this.geomMetadata=d.geomDataIndexes=null}for(var f=d.mesh2frag=
{},c=d.packIds,g=d.entityIndexes,b=0,e=d.length;b<e;b++){var h=c[b]+":"+g[b],k=f[h];void 0===k?f[h]=b:Array.isArray(k)?k.push(b):f[h]=[k,b]}if(!this.bbox){c=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];e=d.boxes;f=0;for(d=d.length;f<d;f++){g=6*f;for(b=0;3>b;b++)e[g+b]<c[b]&&(c[b]=e[g+b]);for(b=3;6>b;b++)e[g+b]>c[b]&&(c[b]=e[g+b])}this.bbox={min:{x:c[0],y:c[1],z:c[2]},max:{x:c[3],y:c[4],z:c[5]}}}f=a.objectIds;if(null!=f){c=[];d=[];for(b=0;b<f.length;++b)for(e=0;e<this.fragments.length;++e)this.fragments.fragId2dbId[e]==
f[b]&&(c.push(this.fragments.packIds[e]),d.push(e));e=1;f=c.length;for(b=1;b<f;){for(;b<f&&c[b]==c[b-1];)++b;if(f==b)break;c[e++]=c[b++]}c.splice(e-1,f-e);f=[];for(b=0;b<this.geompacks.length;++b)for(e=0;e<c.length;++e)parseInt(this.geompacks[b].id)==c[e]&&f.push(this.geompacks[b]);this.geompacks=f;b=filterFragments(this.fragments,d);this.bbox={min:{x:b[0],y:b[1],z:b[2]},max:{x:b[3],y:b[4],z:b[5]}}}a.loadDoneCB("svf");this.fragments.polygonCounts?(b=performance.now(),this.bvh=new BVHBuilder(this.fragments,
this.simplemats),this.bvh.build(a.bvhOptions),c=performance.now(),debug("BVH build time (worker thread):"+(c-b)),a.loadDoneCB("bvh")):a.loadDoneCB("done")};
function PropertyDatabase(a){function b(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);a=decodeURIComponent(escape(b));return JSON.parse(a)}function c(a,b){for(var c=b,d="";c<a.length-1;){var e=a[c];if(44==e&&(10==a[c+1]||13==a[c+1]))break;if(10==e||13==e)break;d+=String.fromCharCode(e);c++}try{var f=decodeURIComponent(escape(d));return JSON.parse(f)}catch(g){return console.error("Error parsing property blob to JSON : "+d),d}}function d(a,b){for(var c=0,d=0,e=a.length;d<e;d++)44==
a[d]&&c++;c++;for(var e=new Uint32Array(c+(b?1:0)),d=0,f=a.length;91!=a[d]&&d<f;)d++;if(d==a.length)return null;d++;for(var g=!1,h=c=0;d<f;){var p=a[d];48<=p&&57>=p?(h=10*h+(p-48),g=!0):44==p||93==p?g&&(e[c++]=h,g=!1,h=0):(g=!1,h=0);d++}return e}function e(a){for(var b=0,c=a.length-1,d=0;d<c;d++)44!=a[d]||10!=a[d+1]&&13!=a[d+1]||b++;if(!b)return null;b++;for(var e=new Uint32Array(b),b=d=0;91!=a[d]&&d<c;)d++;d++;e[b++]=d;for(var f=!1;d<c;)10==a[d]||13==a[d]?f=!0:f&&(f=!1,e[b++]=d),d++;return e}var f,
g,h,k,m,n,q,r,l,u,t,p,y,z,C;for(C in a.attrs){f=b(a.attrs[C]);for(var w=0;w<f.length;w++)switch(f[w][1]){case "__parent__":l=w;break;case "__child__":r=w;break;case "__name__":u=w;break;case "__instanceof__":t=w;break;case "__viewable_in__":p=w;break;case "__externalref__":y=w}break}for(C in a.avs){h=d(a.avs[C],0);delete a.avs;break}for(C in a.offsets){g=d(a.offsets[C],1);g[g.length-1]=h.length/2;delete a.offsets;break}for(C in a.values){k=a.values[C];m=e(k);break}for(C in a.ids){n=a.ids[C];q=e(n);
break}this.getObjectCount=function(){return g.length-1};this.getValueAt=function(a){return c(k,m[a])};this.getIntValueAt=function(a){var b=0;a=m[a];for(34==k[a]&&a++;a<k.length-1;){var c=k[a];if(44==c&&(10==k[a+1]||13==k[a+1]))break;if(10==c||13==c||34==c)break;48<=c&&57>=c&&(b+=10*b+(c-48));a++}return b};this.getIdAt=function(a){return c(n,q[a])};this.getObjectProperties=function(a){var b={dbId:a,name:"",externalId:this.getIdAt(a),properties:[]},c=null,d=2*g[a+1];for(a=2*g[a];a<d;a+=2){var e=h[a];
if(e==u){var k=this.getValueAt(h[a+1]);b.name=k}else e==t?(k=this.getObjectProperties(this.getValueAt(h[a+1])))&&k.properties&&(c=k):(k=f[e],e=(k[6]?k[6]:0)&1||e==l||e==r||e==p||e==y,b.properties.push({displayName:k[5]?k[5]:k[0],displayValue:this.getValueAt(h[a+1]),displayCategory:k[1],type:k[2],units:k[3],hidden:e}))}if(c){d={};k=b.properties;for(a=0;a<k.length;a++)d[k[a].displayName]=1;b.name||(b.name=c.name);c=c.properties;for(a=0;a<c.length;a++)d.hasOwnProperty(c[a].displayName)||k.push(c[a])}return b};
this.getExternalIdMapping=function(){if(!z&&(z={},q&&"length"in q))for(var a=1,b=q.length;a<b;++a){var c=this.getIdAt(a);z[c]=a}return z};this.findRootNodes=function(){for(var a=[],b=1,c=g.length;b<c;b++){for(var d=!1,e=!1,f=!1,p=2*g[b+1],k=2*g[b];k<p;k+=2){var m=h[k];m==l?this.getIntValueAt(h[k+1])&&(e=!0):m==r?d=!0:m==u&&(f=!0)}d&&f&&!e&&a.push(b)}return a};this.getNodeNameAndChildren=function(a,b){for(var c=a.dbId,d=2*g[c+1],e,c=2*g[c];c<d;c+=2){var f=h[c];f!=l&&(f!=r||b?f==u?(f=this.getValueAt(h[c+
1]),a.name=f):f==t&&(f={dbId:this.getValueAt(h[c+1]),name:null},this.getNodeNameAndChildren(f,!0),f&&f.name&&!a.name&&(a.name=f.name)):(f=this.getValueAt(h[c+1]),f={dbId:f,parent:a},e?e.push(f):e=[f]))}return e};this.buildObjectTree=function(a,b,c,d){c>d[0]&&(d[0]=c);var e=this.getNodeNameAndChildren(a);if(e){for(var f=0;f<e.length;f++)this.buildObjectTree(e[f],b,c+1,d);for(f=0;f<e.length;f++)if(e[f].children||void 0!==e[f].fragIds)a.children?a.children.push(e[f]):a.children=[e[f]]}b=b[a.dbId];void 0!==
b&&(a.fragIds=b)};this.bruteForceSearch=function(a,b){a=a.toLowerCase();for(var c=a.match(/\w+|"[^"]+"/g),d=c.length;d--;)c[d]=c[d].replace(/"/g,"");for(var e=[],d=0;d<c.length;d++)1<c[d].length&&e.push(c[d]);if(0===e.length)return[];for(var c=[],p=0;p<e.length;p++){for(var l=[],k=[],d=0,n=m.length;d<n;d++){var q=this.getValueAt(d);"string"==typeof q?-1!=q.toLowerCase().indexOf(e[p])&&k.push(d):-1!=q.toString().toLowerCase().indexOf(e[p])&&k.push(d)}n=1;for(q=g.length;n<q;n++)for(var r=2*g[n+1],d=
2*g[n];d<r;d+=2)if(!(-1==k.indexOf(h[d+1])||b&&b.length&&-1===b.indexOf(f[h[d]][0]))){l.push(n);break}c.push(l)}if(1===c.length)return c[0];e={};l=c[0];for(d=0;d<l.length;d++)e[l[d]]=1;for(k=1;k<c.length;k++){l=c[k];n={};for(d=0;d<l.length;d++)1===e[l[d]]&&(n[l[d]]=1);e=n}l=[];for(p in e)l.push(parseInt(p));return l}}
function F2D(a,b,c,d){function e(a){a=a.children;if(void 0!==a){for(var b=0;b<a.length;++b)e(a[b]);a.sort(function(a,b){var c=a.isLayer,d=b.isLayer;return c&&!d?-1:!c&&d?1:a.name.localeCompare(b.name,void 0,{sensitivity:"base",numeric:!0})})}}function f(a){var b=0;if(a.isLayer)b=1;else{for(var c=a.children,d=0;d<c.length;++d)b+=f(c[d]);a.childCount=b}return b}this.metadata=a;this.scaleY=this.scaleX=1;this.bbox={min:{x:0,y:0,z:0},max:{x:0,y:0,z:0}};this.is2d=!0;this.layersMap={};this.layersRoot={name:"root",
id:"root",children:[],isLayer:!1,childCount:0};this.fontDefs={};this.fontId=this.fontCount=0;this.manifestAvailable=!1;this.objectMemberQueue=[];this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],rcv_offsets:[],rcvs:[],viewables:[]};if(a){var g=function(a,b,c){var d=k,e=a.length;if(1<e)for(var f=0;f<e-1;++f){var g=a[f],h;a:{h=d.children;for(var l=0;l<h.length;++l){var q=h[l];if(q.name===g){h=q;break a}}h=null}h||(h={name:g,id:"group-"+m++,children:[],isLayer:!1,childCount:0},d.children.push(h));
d=h}d.children.push({name:b,index:c,id:n++,isLayer:!0})},h=a.page_dimensions;this.paperWidth=h.page_width;this.paperHeight=h.page_height;this.scaleX=this.paperWidth/h.plot_width;this.scaleY=this.paperHeight/h.plot_height;this.hidePaper=h.hide_paper;this.bbox.max.x=this.paperWidth;this.bbox.max.y=this.paperHeight;var k=this.layersRoot,m=0,n=0,h=0;this.layersMap[0]=h++;for(var q in a.layers){var r=parseInt(q),l=a.layers[q];(l="string"===typeof l?l:l.name)||(l=q);g(l.split("|"),l,r);this.layersMap[r]=
h++}this.layerCount=h}this.hidePaper=this.hidePaper||d&&d.modelSpace;e(this.layersRoot);f(this.layersRoot);this.opCount=0;this.fontFaces=[];this.fontFamilies=[];this.clip=null;this.maxObjectNumber=this.imageNumber=this.objectNumber=0;this.objectStack=[];this.objectNameStack=[];this.parseObjState={polyTriangle:{},clip:{},raster:{},text:{},fontDef:{},uknown:{}};this.layer=0;this.bgColor=d.bgColor?d.bgColor:4294967295;this.contrastColor=this.color=this.fillColor=4278190080;this.currentVbb=new VertexBufferBuilder(!1);
this.meshes=[];this.numPolytriangles=this.numTriangles=this.numCircles=this.numEllipses=this.numPolylines=this.numLineSegs=0;this.error=!1;this.offsetY=this.offsetX=0;if(b){this.manifestAvailable=!0;this.imageId2URI={};a=b.assets;b=0;for(d=a.length;b<d;++b)g=a[b],-1!=g.mime.indexOf("image/")&&(q=g.id,q=q.substr(0,q.indexOf(".")),this.imageId2URI[q]=c+g.URI),"Autodesk.CloudPlatform.PropertyAttributes"==g.type&&this.propertydb.attrs.push(g.URI),"Autodesk.CloudPlatform.PropertyValues"==g.type&&this.propertydb.values.push(g.URI),
"Autodesk.CloudPlatform.PropertyIDs"==g.type&&this.propertydb.ids.push(g.URI),"Autodesk.CloudPlatform.PropertyViewables"==g.type&&this.propertydb.viewables.push(g.URI),"Autodesk.CloudPlatform.PropertyOffsets"==g.type&&(-1!=g.id.indexOf("rcv")?this.propertydb.rcv_offsets.push(g.URI):this.propertydb.offsets.push(g.URI)),"Autodesk.CloudPlatform.PropertyAVs"==g.type&&this.propertydb.avs.push(g.URI),"Autodesk.CloudPlatform.PropertyRCVs"==g.type&&this.propertydb.rcvs.push(g.URI);debug(JSON.stringify(this.propertydb))}}
F2D.prototype.load=function(a,b){31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress());this.data=b;this.parse();a.loadDoneCB(!0)};F2D.prototype.loadFrames=function(a){a.data?this.data=new Uint8Array(a.data):a.finalFrame&&(this.data=null);this.parseFrames(a.finalFrame);a.loadDoneCB(!0)};
var F2dDataType={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_varint:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,dt_double_drray:35,dt_varint_array:36,dt_point_varint_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},F2dSemanticType={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,
st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_font_ref:16,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_font_def:37,st_sheet:42,st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_dot:48,st_end_object:63,st_last_semantic_type:127};
F2D.prototype.flushBuffer=function(a,b){if(this.currentVbb.vcount){var c;if(c=b||this.currentVbb.isFull(a))c=this.currentVbb.toMesh(),VBUtils.bboxUnion(this.bbox,c.boundingBox),this.meshes.push(c),c.material={skipEllipticals:!this.currentVbb.numEllipticals,skipCircles:!this.currentVbb.numCirculars,skipTriangleGeoms:!this.currentVbb.numTriangleGeoms,useInstancing:this.currentVbb.useInstancing},this.currentImage&&(c.material.image=this.currentImage,c.material.image.name=this.imageNumber++,this.currentImage=
null),this.currentVbb=new VertexBufferBuilder}};F2D.prototype.tx=function(a){return this.sx(a)};F2D.prototype.ty=function(a){return this.sy(a)};F2D.prototype.sx=function(a){return a*this.scaleX};F2D.prototype.sy=function(a){return a*this.scaleY};F2D.prototype.invertColor=function(a){var b,c,d;b=255-(a>>16&255);c=255-(a>>8&255);d=255-(a&255);return(a>>24&255)<<24|b<<16|c<<8|d};F2D.prototype.mapColor=function(a){return a};F2D.prototype.restoreSignBitFromLSB=function(a){return a&1?-(a>>>1):a>>>1};
F2D.prototype.parsePointPositions=function(){var a=this.stream.getVarints(),b=this.stream.getVarints(),a=this.restoreSignBitFromLSB(a),b=this.restoreSignBitFromLSB(b),a=a+this.offsetX,b=b+this.offsetY;this.offsetX=a;this.offsetY=b;return[this.tx(a),this.ty(b)]};F2D.prototype.parserAssert=function(a,b,c){return a!=b?(debug("Expect "+b+"; actual type is "+a+"; in function "+c),this.error=!0):!1};F2D.prototype.unhandledTypeWarning=function(a,b){debug("Unhandled semantic type : "+b+" in function "+a)};
F2D.prototype.parseObject=function(){var a=this.stream.getVarints();this.objectStack.push(a);switch(a){case F2dSemanticType.st_sheet:this.objectNameStack.push("sheet");this.objectMemberQueue.unshift("paperColor");break;case F2dSemanticType.st_clip:this.objectNameStack.push("clip");this.objectMemberQueue.unshift("contourCounts","points");break;case F2dSemanticType.st_polytriangle:this.objectNameStack.push("polyTriangle");this.objectMemberQueue.unshift("points","indices","colors");break;case F2dSemanticType.st_raster:this.objectNameStack.push("raster");
this.objectMemberQueue.unshift("position","width","height","imageId");break;case F2dSemanticType.st_text:this.objectNameStack.push("text");this.objectMemberQueue.unshift("string","position","height","widthScale","rotation","oblique","charWidths");break;case F2dSemanticType.st_font_def:this.objectNameStack.push("fontDef");this.objectMemberQueue.unshift("name","fullName","flags","spacing","panose");break;case F2dSemanticType.st_end_object:this.objectStack.pop();if(this.objectStack.length){switch(this.objectStack.pop()){case F2dSemanticType.st_polytriangle:this.actOnPolyTriangle();
break;case F2dSemanticType.st_clip:this.actOnClip();break;case F2dSemanticType.st_raster:this.actOnRaster();break;case F2dSemanticType.st_text:this.actOnText();break;case F2dSemanticType.st_font_def:this.actOnFontDef()}var a=this.objectNameStack.pop(),a=this.parseObjState[a],b;for(b in a)a[b]=null}else this.parserAssert(0,1,"parseEndObject (Stack Empty)");this.objectMemberQueue.length=0;break;default:this.objectNameStack.push("unknown"),this.error=!0,this.unhandledTypeWarning("parseObject",a)}};
F2D.prototype.initSheet=function(a){this.bgColor=a;if(!this.hidePaper&&this.metadata){var b=this.paperWidth,c=this.paperHeight,d=this.currentVbb,e=.0075*b;this.addPolyTriangle([0,0,b,0,b,c,0,c,e,-e,b+e,-e,b+e,0,e,0,b,0,b+e,0,b+e,c-e,b,c-e],[a,a,a,a,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485],[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11],4294967295,0,4294967295,!1);d.addSegment(0,0,b,0,1E-6,4278190080,4294967295,0);d.addSegment(b,0,b,c,1E-6,4278190080,4294967295,
0);d.addSegment(b,c,0,c,1E-6,4278190080,4294967295,0);d.addSegment(0,c,0,0,1E-6,4278190080,4294967295,0)}};F2D.prototype.setObjectMember=function(a){if(!this.objectMemberQueue.length)return debug("Unexpected object member. "+a),!1;var b=this.objectMemberQueue.shift(),c=this.objectNameStack[this.objectNameStack.length-1];return"sheet"==c&&"paperColor"==b?(this.initSheet(a),!0):c?(this.parseObjState[c][b]=a,!0):!1};
F2D.prototype.parseString=function(){var a=this.stream,b=a.getVarints(),c=a.getVarints(),a=a.getString(c);switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return;break;default:debug("Unexpected opcode semantic type for string.")}return a};F2D.prototype.actOnFontDef=function(){var a=this.parseObjState.fontDef;this.fontDefs[++this.fontCount]=a;this.fontId=this.fontCount};
F2D.prototype.parsePoint=function(){var a=this.stream.getVarints(),b=this.parsePointPositions();switch(a){case F2dSemanticType.st_object_member:if(this.setObjectMember(b))return;break;default:debug("Unexpected opcode semantic type for point.")}return b};
F2D.prototype.parsePointsArray=function(){var a=this.stream,b=a.getVarints();if(a=a.getVarints()){for(var a=a/2,c=[],d,e=0;e<a;++e)d=this.parsePointPositions(),c.push(d[0]),c.push(d[1]);switch(b){case F2dSemanticType.st_polyline:this.actOnPolylinePointsArray(c);return;case F2dSemanticType.st_dot:this.actOnDot(c);return;case F2dSemanticType.st_object_member:if(this.setObjectMember(c))return;break;default:debug("Unexpected opcode semantic type for points array.")}return c}};
F2D.prototype.parseIntArray=function(){for(var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=[],e=0;e<c;++e)d.push(a.getUint32());switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(d))return;break;default:this.unhandledTypeWarning("parseIntArray",b)}return d};
F2D.prototype.parseByteArray=function(){for(var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=[],e=0;e<c;++e)d.push(a.getUint8());switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(d))return;break;default:this.unhandledTypeWarning("parseByteArray",b)}return d};
F2D.prototype.parseVarintArray=function(){for(var a=this.stream,b=a.getVarints(),c=[],d=a.getVarints(),e=0;e<d;++e)c.push(a.getVarints());switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(c))return;break;default:this.unhandledTypeWarning("parseVarIntArray",b)}return c};
F2D.prototype.parseInt=function(){var a=this.stream,b=a.getVarints(),a=a.getUint32();switch(b){case F2dSemanticType.st_color:this.color=a;break;case F2dSemanticType.st_fill:this.fill=!0;this.fillColor=a;break;case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return;default:this.unhandledTypeWarning("parseInt",b)}return a};
F2D.prototype.parseVoid=function(){var a=this.stream.getVarints();switch(a){case F2dSemanticType.st_fill_off:this.fill=!1;break;default:this.unhandledTypeWarning("parseVoid",a)}};
F2D.prototype.parseVarint=function(){var a=this.stream,b=a.getVarints(),a=a.getVarints();switch(b){case F2dSemanticType.st_line_weight:this.lineWeight=this.tx(a);break;case F2dSemanticType.st_object_id:case F2dSemanticType.st_markup_id:this.objectNumber=a;this.maxObjectNumber=Math.max(this.maxObjectNumber,a);break;case F2dSemanticType.st_layer:this.layer=this.layersMap[a];break;case F2dSemanticType.st_font_ref:this.fontId=a;break;case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return}return a};
F2D.prototype.parseFloat=function(){var a=this.stream,b=a.getVarints(),a=a.getFloat32();switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return}return a};F2D.prototype.parseCircularArc=function(){var a=this.stream,b=a.getVarints();if(!this.parserAssert(b,F2dSemanticType.st_arc,"parseCircularArc")){var b=this.parsePointPositions(),c=a.getVarints(),d=a.getFloat32(),a=a.getFloat32();this.actOnCircularArc(b[0],b[1],d,a,this.sx(c))}};
F2D.prototype.parseCircle=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dSemanticType.st_arc,"parseCircle")||(b=this.parsePointPositions(),a=a.getVarints(),this.actOnCompleteCircle(b[0],b[1],this.sx(a)))};
F2D.prototype.parseArc=function(){var a=this.stream,b=a.getVarints();if(!this.parserAssert(b,F2dSemanticType.st_arc,"parseArc")){var b=this.parsePointPositions(),c=a.getVarints(),d=a.getVarints(),e=a.getFloat32(),f=a.getFloat32(),a=a.getFloat32();this.actOnArc(b[0],b[1],f,a,this.sx(c),this.sy(d),e)}};
F2D.prototype.parseDataType=function(){var a=this.stream.getVarints();switch(a){case F2dDataType.dt_void:this.parseVoid();break;case F2dDataType.dt_int:this.parseInt();break;case F2dDataType.dt_object:this.parseObject();break;case F2dDataType.dt_varint:this.parseVarint();break;case F2dDataType.dt_point_varint:this.parsePoint();break;case F2dDataType.dt_float:this.parseFloat();break;case F2dDataType.dt_point_varint_array:this.parsePointsArray();break;case F2dDataType.dt_circular_arc:this.parseCircularArc();
break;case F2dDataType.dt_circle:this.parseCircle();break;case F2dDataType.dt_arc:this.parseArc();break;case F2dDataType.dt_int_array:this.parseIntArray();break;case F2dDataType.dt_varint_array:this.parseVarintArray();break;case F2dDataType.dt_byte_array:this.parseByteArray();break;case F2dDataType.dt_string:this.parseString();break;default:this.error=!0,debug("Data type not supported yet: "+a)}};
F2D.prototype.parse=function(){var a=this.stream=new InputStream(this.data),b=a.getString(3);if("F2D"!=b)debug("Invalid F2D header : "+b);else if(b=a.getString(2),"01"!=b)debug("Only support f2d major version 1; actual version is : "+b);else if("."!=a.getString(1))debug("Invalid version delimiter.");else{for(a.getString(2);a.offset<a.byteLength;){this.parseDataType();if(this.error)break;this.opCount++}this.flushBuffer(0,!0);this.data=this.stream=this.currentVbb=null;debug("F2d parse: data types count : "+
this.opCount)}};F2D.prototype.parseFrames=function(a){if(this.data)for(var b=this.stream=new InputStream(this.data);b.offset<b.byteLength;){this.parseDataType();if(this.error)break;this.opCount++}else a||debug("Unexpected F2D parse state: If there is no data, we only expect a flush command, but flush was false.");a&&this.flushBuffer(0,!0);this.data=this.stream=null};
F2D.prototype.actOnPolylinePointsArray=function(a){this.flushBuffer();this.numPolylines++;for(var b=a.length/2,c=a[0],d=a[1],e=1;e<b;++e){var f=a[2*e],g=a[2*e+1];this.currentVbb.addSegment(c,d,f,g,this.lineWeight,this.color,this.objectNumber,this.layer);c=f;d=g}this.numLineSegs+=b-1};F2D.prototype.actOnDot=function(a){this.actOnCompleteCircle(a[0],a[1],this.sx(1))};
F2D.prototype.actOnCompleteCircle=function(a,b,c){this.flushBuffer();this.numCircles++;this.fill?this.currentVbb.addSegment(a,b,a,b,2*c,this.color,this.objectNumber,this.layer,!0,!1,!0):this.currentVbb.addCircularArc(a,b,0,2*Math.PI,c,this.lineWeight,this.color,this.objectNumber,this.layer)};F2D.prototype.actOnCircularArc=function(a,b,c,d,e){this.numCircles++;this.flushBuffer();this.currentVbb.addCircularArc(a,b,c,d,e,this.lineWeight,this.color,this.objectNumber,this.layer)};
F2D.prototype.actOnArc=function(a,b,c,d,e,f,g){this.numEllipses++;this.flushBuffer();this.currentVbb.addEllipticalArc(a,b,c,d,e,f,g,this.lineWeight,this.color,this.objectNumber,this.layer)};
F2D.prototype.actOnRaster=function(){if(this.manifestAvailable){this.flushBuffer(4,!0);var a=this.parseObjState.raster,b=a.position,c=a.height,d=a.imageId,e=b[0],b=b[1],a=this.sx(a.width),c=this.sy(c),d={dataURI:this.imageId2URI[d],width:a,height:c};this.currentVbb.addTexturedQuad(e,b-c,a,c,this.objectNumber,this.layer);this.currentImage=d;this.flushBuffer(0,!0)}};F2D.prototype.actOnClip=function(){};F2D.prototype.actOnText=function(){};
F2D.prototype.addPolyTriangle=function(a,b,c,d,e,f,g){function h(a,b){if(a>b){var c=a;a=b;b=c}if(q[a]){var c=q[a],d=c.lastIndexOf(b);-1==d?c.push(b):c[d]=-1}else q[a]=[b]}function k(){for(var c=0,h=q.length;c<h;c++){var g=q[c];if(g)for(var p=0;p<g.length;p++){var l=g[p];-1!=l&&(n.flushBuffer(4),n.currentVbb.addSegment(a[2*c],a[2*c+1],a[2*l],a[2*l+1],r,b?b[c]:d,f,e),b&&b[c]!=b[l]&&debug("Gouraud triangle encountered. Will have incorrect antialiasing."))}}}function m(c,h){if(c>h){var g=c;c=h;h=g}(g=
q[c])&&-1!=g.indexOf(h)&&(n.flushBuffer(4),n.currentVbb.addSegment(a[2*c],a[2*c+1],a[2*h],a[2*h+1],r,b?b[c]:d,f,e),b&&b[c]!=b[h]&&debug("Gouraud triangle encountered. Will have incorrect antialiasing."))}var n=this,q=null,r=-1;this.objectStack[this.objectStack.length-1]==F2dSemanticType.st_text&&(r=-.5);if(g)for(var q=Array(a.length/2),l=0,u=c.length;l<u;l+=3){var t=c[l],p=c[l+1],y=c[l+2];h(t,p);h(p,y);h(y,t)}if(this.currentVbb.useInstancing)for(u=c.length,l=0;l<u;l+=3)t=c[l],p=c[l+1],y=c[l+2],this.flushBuffer(4),
this.currentVbb.addTriangleGeom(a[2*t],a[2*t+1],a[2*p],a[2*p+1],a[2*y],a[2*y+1],b?b[t]:d,f,e),g&&(m(t,p),m(p,y),m(y,t));else{u=a.length/2;this.flushBuffer(u);t=this.currentVbb;p=t.vcount;for(l=0;l<u;++l)t.addVertexPolytriangle(a[2*l],a[2*l+1],0,0,0,b?b[l]:d,f,e);u=c.length;for(l=0;l<u;l+=3)t.addTriangle(p+c[l],p+c[l+1],p+c[l+2]);g&&k()}};
F2D.prototype.actOnPolyTriangle=function(){var a=this.parseObjState.polyTriangle;this.parseObjState.polyTriangle={};var b=a.points,c=a.indices,a=a.colors;b&&c?(this.numPolytriangles++,this.numTriangles+=c.length/3,this.addPolyTriangle(b,a,c,this.color,this.layer,this.objectNumber,!0)):debug("Malformed polytriangle.")};function F2DProbe(){this.data=null;this.frameEnd=this.frameStart=0;this.stream=null;this.opCount=0;this.marker={frameStart:this.frameStart,frameEnd:this.frameEnd}}
F2DProbe.prototype.load=function(a){this.data=a;this.frameStart=0;this.stream?(this.stream.reset(this.data),this.stream.seek(0),this.frameEnd=0):(this.stream=new CheckedInputStream(this.data),this.stream.seek(8),this.frameEnd=this.frameStart=8);this.probe();this.marker.frameStart=this.frameStart;this.marker.frameEnd=this.frameEnd;return this.marker};
var F2dProbeDataType={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_varint:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,dt_double_drray:35,dt_varint_array:36,dt_point_varint_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},F2dProbeSemanticType={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,
st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_font_ref:16,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_font_def:37,st_sheet:42,st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_dot:48,st_end_object:63,st_last_semantic_type:127};F2DProbe.prototype.readColor=function(){var a=this.stream;a.getVarints();a.getVarints();a.skipUint32()};F2DProbe.prototype.parsePointPositions=function(){this.stream.getVarints();this.stream.getVarints()};
F2DProbe.prototype.unhandledTypeWarning=function(a,b){debug("Unhandled semantic type when probing F2d : "+b+" in function "+a)};F2DProbe.prototype.parseObject=function(){this.stream.getVarints()};F2DProbe.prototype.parseString=function(){var a=this.stream;a.getVarints();var b=a.getVarints();a.skipBytes(b)};F2DProbe.prototype.parsePoint=function(){this.stream.getVarints();this.parsePointPositions()};
F2DProbe.prototype.parseVarintArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.getVarints()};F2DProbe.prototype.parseByteArray=function(){var a=this.stream;a.getVarints();var b=a.getVarints();a.skipBytes(b)};F2DProbe.prototype.parseEndOfObject=function(){var a=this.stream;a.getVarints();a.getVarints()};F2DProbe.prototype.parsePointsArray=function(a){a=this.stream;a.getVarints();if(a=a.getVarints()){a/=2;for(var b=0;b<a;++b)this.parsePointPositions()}};
F2DProbe.prototype.parsePoint=function(a){this.stream.getVarints();this.parsePointPositions()};F2DProbe.prototype.parseInt=function(){var a=this.stream,b=a.getVarints();switch(b){case F2dProbeSemanticType.st_color:a.skipUint32();break;case F2dProbeSemanticType.st_fill:a.skipUint32();break;default:a.skipUint32(),this.unhandledTypeWarning("parseInt",b)}};
F2DProbe.prototype.parseVoid=function(){var a=this.stream.getVarints();switch(a){case F2dProbeSemanticType.st_fill_off:break;default:this.unhandledTypeWarning("parseVoid",a)}};F2DProbe.prototype.parseVarint=function(){this.stream.getVarints();this.stream.getVarints()};F2DProbe.prototype.parseIntArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.skipUint32()};F2DProbe.prototype.parseFloat=function(){var a=this.stream;a.getVarints();a.getFloat32()};
F2DProbe.prototype.parseCircularArc=function(){var a=this.stream;a.getVarints();this.parsePointPositions();a.getVarints();a.getFloat32();a.getFloat32()};F2DProbe.prototype.parseCircle=function(){var a=this.stream;a.getVarints();this.parsePointPositions();a.getVarints()};F2DProbe.prototype.parseArc=function(){var a=this.stream;a.getVarints();this.parsePointPositions();a.getVarints();a.getVarints();a.getFloat32();a.getFloat32();a.getFloat32()};
F2DProbe.prototype.parseDataType=function(){var a=this.stream.getVarints();switch(a){case F2dProbeDataType.dt_void:this.parseVoid();break;case F2dProbeDataType.dt_int:this.parseInt();break;case F2dProbeDataType.dt_object:this.parseObject();break;case F2dProbeDataType.dt_varint:this.parseVarint();break;case F2dProbeDataType.dt_float:this.parseFloat();break;case F2dProbeDataType.dt_point_varint:this.parsePoint();break;case F2dProbeDataType.dt_point_varint_array:this.parsePointsArray();break;case F2dProbeDataType.dt_circular_arc:this.parseCircularArc();
break;case F2dProbeDataType.dt_circle:this.parseCircle();break;case F2dProbeDataType.dt_arc:this.parseArc();break;case F2dProbeDataType.dt_varint_array:this.parseVarintArray();break;case F2dProbeDataType.dt_int_array:this.parseIntArray();break;case F2dProbeDataType.dt_byte_array:this.parseByteArray();break;case F2dProbeDataType.dt_string:this.parseString();break;default:this.error=!0,debug("Bad op code encountered : "+a+" , bail out.")}this.error||(this.frameEnd=this.stream.offset)};
F2DProbe.prototype.probe=function(){var a=this.stream;try{for(;a.offset<a.byteLength;){this.parseDataType();if(this.error)break;this.opCount++}}catch(b){}};function CheckedInputStream(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf)}
function OutOfBoundsBufferAccessException(a){this.offset=a;this.message="try to access an offset that is out of bounds: "+this.offset;this.toString=function(){return this.message}}CheckedInputStream.prototype.boundsCheck=function(a){if(a>=this.byteLength)throw new OutOfBoundsBufferAccessException(a);};CheckedInputStream.prototype.seek=function(a){this.boundsCheck(a);this.offset=a};
CheckedInputStream.prototype.getBytes=function(a){this.boundsCheck(this.offset+a);var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};CheckedInputStream.prototype.skipBytes=function(a){this.boundsCheck(this.offset+a);this.offset+=a};CheckedInputStream.prototype.getVarints=function(){var a,b=0,c=0;do this.boundsCheck(this.offset),a=this.buffer[this.offset++],b|=(a&127)<<c,c+=7;while(a&128);return b};
CheckedInputStream.prototype.getUint8=function(){this.boundsCheck(this.offset+1);return this.buffer[this.offset++]};CheckedInputStream.prototype.getUint16=function(){this.boundsCheck(this.offset+2);this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};CheckedInputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};
CheckedInputStream.prototype.getInt32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};CheckedInputStream.prototype.getUint32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};
CheckedInputStream.prototype.skipUint32=function(){this.boundsCheck(this.offset+4);this.offset+=4};CheckedInputStream.prototype.getFloat32=function(){this.boundsCheck(this.offset+4);this.offset+=4;return 0};CheckedInputStream.prototype.getFloat64=function(){this.boundsCheck(this.offset+8);this.offset+=8;return 0};CheckedInputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};
function NodeArray(a,b){this.bytes_per_node=b?32:36;var c,d;a instanceof ArrayBuffer?(c=a.byteLength/this.bytes_per_node,d=a,this.nodeCount=c):(c=a|0,d=new ArrayBuffer(this.bytes_per_node*c),this.nodeCount=0);this.nodeCapacity=c;this.nodesRaw=d;this.is_lean_node=b;this.node_stride=this.bytes_per_node/4;this.node_stride_short=this.bytes_per_node/2;this.nodesF=new Float32Array(this.nodesRaw);this.nodesI=new Int32Array(this.nodesRaw);this.nodesS=new Uint16Array(this.nodesRaw)}
NodeArray.prototype.setLeftChild=function(a,b){this.nodesI[a*this.node_stride+6]=b};NodeArray.prototype.getLeftChild=function(a){return this.nodesI[a*this.node_stride+6]};NodeArray.prototype.setPrimStart=function(a,b){this.is_lean_node?this.nodesI[a*this.node_stride+6]=b:this.nodesI[a*this.node_stride+8]=b};NodeArray.prototype.getPrimStart=function(a){return this.is_lean_node?this.nodesI[a*this.node_stride+6]:this.nodesI[a*this.node_stride+8]};
NodeArray.prototype.setPrimCount=function(a,b){this.nodesS[a*this.node_stride_short+14]=b};NodeArray.prototype.getPrimCount=function(a){return this.nodesS[a*this.node_stride_short+14]};NodeArray.prototype.setFlags=function(a,b,c,d){this.nodesS[a*this.node_stride_short+15]=d<<3|c<<2|b&3};NodeArray.prototype.getFlags=function(a){return this.nodesS[a*this.node_stride_short+15]};
NodeArray.prototype.setBox0=function(a,b){var c=a*this.node_stride,d=this.nodesF;d[c]=b[0];d[c+1]=b[1];d[c+2]=b[2];d[c+3]=b[3];d[c+4]=b[4];d[c+5]=b[5]};NodeArray.prototype.getBoxThree=function(a,b){var c=a*this.node_stride,d=this.nodesF;b.min.x=d[c];b.min.y=d[c+1];b.min.z=d[c+2];b.max.x=d[c+3];b.max.y=d[c+4];b.max.z=d[c+5]};NodeArray.prototype.setBoxThree=function(a,b){var c=a*this.node_stride,d=this.nodesF;d[c]=b.min.x;d[c+1]=b.min.y;d[c+2]=b.min.z;d[c+3]=b.max.x;d[c+4]=b.max.y;d[c+5]=b.max.z};
NodeArray.prototype.makeEmpty=function(a){a*=this.node_stride;var b=this.nodesI;b[a+6]=-1;b[a+7]=0;this.is_lean_node||(b[a+8]=-1)};NodeArray.prototype.realloc=function(a){if(this.nodeCount+a>this.nodeCapacity){var b=0|3*this.nodeCapacity/2;b<this.nodeCount+a&&(b=this.nodeCount+a);a=new ArrayBuffer(b*this.bytes_per_node);var c=new Int32Array(a);c.set(this.nodesI);this.nodeCapacity=b;this.nodesRaw=a;this.nodesF=new Float32Array(a);this.nodesI=c;this.nodesS=new Uint16Array(a)}};
NodeArray.prototype.nextNodes=function(a){this.realloc(a);var b=this.nodeCount;this.nodeCount+=a;for(var c=0;c<a;c++)this.makeEmpty(b+c);return b};NodeArray.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)};
var BOX_STRIDE=6,POINT_STRIDE=3,BOX_EPSILON=1E-5,BOX_SCALE_EPSILON=1E-5,MAX_DEPTH=15,MAX_BINS=16,BVHModule=function(){function a(a,b,c){a[0]>b[c]&&(a[0]=b[c]);a[3]<b[c]&&(a[3]=b[c]);a[1]>b[c+1]&&(a[1]=b[c+1]);a[4]<b[c+1]&&(a[4]=b[c+1]);a[2]>b[c+2]&&(a[2]=b[c+2]);a[5]<b[c+2]&&(a[5]=b[c+2])}function b(a,b,c){a[0]>b[c]&&(a[0]=b[c]);a[1]>b[c+1]&&(a[1]=b[c+1]);a[2]>b[c+2]&&(a[2]=b[c+2]);a[3]<b[c+3]&&(a[3]=b[c+3]);a[4]<b[c+4]&&(a[4]=b[c+4]);a[5]<b[c+5]&&(a[5]=b[c+5])}function c(a,b){a[0]>b[0]&&(a[0]=b[0]);
a[1]>b[1]&&(a[1]=b[1]);a[2]>b[2]&&(a[2]=b[2]);a[3]<b[3]&&(a[3]=b[3]);a[4]<b[4]&&(a[4]=b[4]);a[5]<b[5]&&(a[5]=b[5])}function d(a,b,c,d){for(var e=0;3>e;e++)a[b+e]=c[d+3+e]-c[d+e]}function e(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5]}function f(a){a[0]=Infinity;a[1]=Infinity;a[2]=Infinity;a[3]=-Infinity;a[4]=-Infinity;a[5]=-Infinity}function g(a){var b=a[3]-a[0],c=a[4]-a[1];a=a[5]-a[2];return 0>b||0>c||0>a?0:2*(b*c+c*a+a*b)}function h(){this.vb_left=new Float32Array(6);this.vb_right=
new Float32Array(6);this.cb_left=new Float32Array(6);this.cb_right=new Float32Array(6);this.num_left=0;this.num_bins=this.best_cost=this.best_split=-1}function k(){this.box_bbox=new Float32Array(6);this.box_centroid=new Float32Array(6);this.num_prims=0}function m(){this.BL=new Float32Array(6);this.CL=new Float32Array(6);this.AL=this.NL=0}h.prototype.reset=function(){this.num_left=0;this.num_bins=this.best_cost=this.best_split=-1};k.prototype.reset=function(){this.num_prims=0;f(this.box_bbox);f(this.box_centroid)};
m.prototype.reset=function(){this.AL=this.NL=0;f(this.BL);f(this.CL)};for(var n=[],q=0;q<MAX_BINS;q++)n.push(new k);for(var r=[],q=0;q<MAX_BINS-1;q++)r.push(new m);var l=new Float32Array(6),u=new Float32Array(6),t=new Float32Array(3);return{bvh_subdivide:function(k,m,q,C,w,B,J,K){d(t,0,B,0);var H=k.nodes,G=J?k.frags_per_leaf_node_transparent:k.frags_per_leaf_node,D=J?k.frags_per_inner_node_transparent:k.frags_per_inner_node,v=k.max_polys_per_node,E=0;t[1]>t[0]&&(E=1);t[2]>t[E]&&(E=2);H.setBox0(m,
w);var F=0;w=0;if(k.polygonCounts)for(var I=q;I<=C&&!(F+=k.polygonCounts[k.primitives[I]],w++,F>v);I++);I=C-q+1;if(I<=G&&F<v||1===I||K>MAX_DEPTH||t[E]<k.scene_epsilon)H.setLeftChild(m,-1),H.setPrimStart(m,q),H.setPrimCount(m,C-q+1),H.setFlags(m,0,0,J?1:0);else{if(D){D=q;E=k.primitives;G=k.centroids;v=C-D+1;v>k.frags_per_inner_node&&(v=k.frags_per_inner_node);v>w&&(v=w);H.setPrimStart(m,D);H.setPrimCount(m,v);D+=v;f(B);for(w=D;w<=C;w++)a(B,G,3*E[w]);d(t,0,B,0);E=0;t[1]>t[0]&&(E=1);t[2]>t[E]&&(E=2);
q+=H.getPrimCount(m)}w=new h;var A=q,D=E;if(t[D]<k.scene_epsilon)w.best_cost=Infinity;else{G=MAX_BINS;G>C-A+1&&(G=C-A+1);for(v=0;v<G;v++)n[v].reset();for(v=0;v<G-1;v++)r[v].reset();var v=w.num_bins=G,F=k.centroids,I=k.primitives,x=k.boxes,M=v*(1-BOX_SCALE_EPSILON)/t[D];B=B[D];for(var N=k.sort_prims;A<=C;A++){var O=I[A]|0,L=M*(F[3*O+D]-B)|0;0>L?L=0:L>=v&&(L=v-1);N[A]=L;n[L].num_prims++;b(n[L].box_bbox,x,6*O);a(n[L].box_centroid,F,3*O)}e(r[0].BL,n[0].box_bbox);e(r[0].CL,n[0].box_centroid);r[0].AL=g(r[0].BL);
r[0].NL=n[0].num_prims;for(v=1;v<G-1;v++)B=n[v],D=r[v],e(D.BL,r[v-1].BL),c(D.BL,B.box_bbox),D.AL=g(D.BL),e(D.CL,r[v-1].CL),c(D.CL,B.box_centroid),D.NL=r[v-1].NL+B.num_prims;v=G-1;e(l,n[v].box_bbox);e(u,n[v].box_centroid);I=g(l);G=n[v].num_prims;D=v;F=I*G+r[v-1].AL*r[v-1].NL;e(w.vb_right,l);e(w.cb_right,n[v].box_centroid);e(w.vb_left,r[v-1].BL);e(w.cb_left,r[v-1].CL);w.num_left=r[v-1].NL;for(--v;1<=v;v--)B=n[v],c(l,B.box_bbox),c(u,B.box_centroid),I=g(l),G+=B.num_prims,B=I*G+r[v-1].AL*r[v-1].NL,B<=
F&&(F=B,D=v,e(w.vb_right,l),e(w.cb_right,u),e(w.vb_left,r[v-1].BL),e(w.cb_left,r[v-1].CL),w.num_left=r[v-1].NL);w.best_split=D;w.best_cost=F}if(0>w.num_bins)H.setPrimCount(m,H.getPrimCount(m)+C-q+1);else{B=k.primitives;G=k.sort_prims;D=0;v=q|0;I=w.best_split|0;for(F=q;F<=C;F++)x=B[F]|0,G[F]<I?B[v++]=x:G[D++]=x;for(F=0;F<D;F++)B[v+F]=G[F];B=H.nextNodes(2);H.setFlags(m,E,.5*(w.vb_left[3+E]+w.vb_left[E])<.5*(w.vb_right[3+E]+w.vb_right[E])?0:1,J?1:0);H.setLeftChild(m,B);k.recursion_stack.push([k,B+1,
q+w.num_left,C,w.vb_right,w.cb_right,J,K+1]);k.recursion_stack.push([k,B,q,q+w.num_left-1,w.vb_left,w.cb_left,J,K+1])}}},compute_boxes:function(c){var e=c.boxv_o,h=c.boxc_o,g=c.boxv_t,l=c.boxc_t;f(e);f(h);f(g);f(l);for(var k=c.centroids,m=c.boxes,n=0,q=c.prim_count;n<q;n++){var r=k,u=3*n,v=m,E=6*n;r[u]=.5*(v[E]+v[E+3]);r[u+1]=.5*(v[E+1]+v[E+4]);r[u+2]=.5*(v[E+2]+v[E+5]);n>=c.first_transparent?(a(l,k,3*n),b(g,m,6*n)):(a(h,k,3*n),b(e,m,6*n))}d(t,0,c.boxv_o,0);e=Math.max(t[0],t[1],t[2]);c.scene_epsilon=
BOX_EPSILON*e},box_area:function(a,b){var c=a[b+3]-a[b],d=a[b+4]-a[b+1],e=a[b+5]-a[b+2];return 0>c||0>d||0>e?0:2*(c*d+d*e+e*c)}}}();
function BVHBuilder(a,b){this.boxes=a.boxes;this.polygonCounts=a.polygonCounts;this.materials=a.materials;this.materialDefs=b;this.prim_count=a.length;this.frags_per_inner_node=this.frags_per_leaf_node=-1;this.nodes=null;this.work_buf=new ArrayBuffer(4*this.prim_count);this.sort_prims=new Int32Array(this.work_buf);this.primitives=new Int32Array(this.prim_count);this.centroids=new Float32Array(POINT_STRIDE*this.prim_count);this.boxv_o=new Float32Array(6);this.boxc_o=new Float32Array(6);this.boxv_t=
new Float32Array(6);this.boxc_t=new Float32Array(6);this.recursion_stack=[]}
BVHBuilder.prototype.sortPrimitives=function(){for(var a=new Float32Array(this.work_buf),b=this.materialDefs,c=this.materials,d=this.primitives,e=0,f=0,g=this.prim_count;f<g;f++){d[f]=f;var h=b[c[f]]?b[c[f]].transparent:!1;h&&e++;k?(a[f]=BVHModule.box_area(this.boxes,BOX_STRIDE*f),h&&(a[f]=-a[f])):a[f]=h?-1:1}var k=!1;if(e&&e<this.prim_count){b=new Int32Array(e);f=h=c=0;for(g=this.prim_count;f<g;f++)0<=a[f]?d[c++]=d[f]:b[h++]=d[f];d.set(b,this.prim_count-e)}this.first_transparent=this.prim_count-
e};
BVHBuilder.prototype.build=function(a){var b=a&&!!a.useSlimNodes;if(b)this.frags_per_leaf_node=1,this.frags_per_inner_node=0,this.frags_per_leaf_node_transparent=1,this.frags_per_inner_node_transparent=0,this.max_polys_per_node=Infinity;else{var c=a.isWeakDevice?.5:1;this.frags_per_leaf_node=0|32*c;this.frags_per_inner_node=0|this.frags_per_leaf_node;this.frags_per_leaf_node_transparent=this.frags_per_leaf_node;this.frags_per_inner_node_transparent=0;this.max_polys_per_node=0|1E4*c}if(this.nodes&&this.nodes.is_lean_node==
b)this.nodes.nodeCount=0;else{b=this.prim_count/this.frags_per_leaf_node;for(c=1;c<b;)c*=2;this.nodes=new NodeArray(c,a?a.useSlimNodes:!1)}this.sortPrimitives();BVHModule.compute_boxes(this);a=this.nodes.nextNodes(2);for(BVHModule.bvh_subdivide(this,a,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);this.recursion_stack.length;)b=this.recursion_stack.pop(),BVHModule.bvh_subdivide(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);for(BVHModule.bvh_subdivide(this,a+1,this.first_transparent,this.prim_count-
1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;)b=this.recursion_stack.pop(),BVHModule.bvh_subdivide(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7])};AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.inWorkerThread="undefined"!==typeof self&&"undefined"===typeof window;a.ViewingService={};a.ViewingService.shouldRefreshToken=function(a){var c=!1;if(401===a.statusCode){a=a.responseText;try{var d=a?JSON.parse(a):{}}catch(e){}c=!a||d.errorCode&&"AUTH-006"===d.errorCode}else c=403===a.statusCode;return c};a.ViewingService.refreshToken=function(b,c){a.inWorkerThread?(self.addEventListener("message",function(a){a.data&&a.data.tokenRefreshed?b(a):c(a)}),self.postMessage({refreshToken:!0})):
a.refreshTokenAndCookie(b,c)};a.ViewingService.generateUrl=function(b,c,d){if(0!==d.indexOf("urn:"))return d;b+="/";"items"!==c&&(d=d.substr(4));return b="bubbles"===c?0==a.env.indexOf("Autodesk")?b+d:b+(c+"/"+d):b+(c+"/"+encodeURIComponent(d))};a.ViewingService.get=function(b,c,d,e,f,g){g=g?g:{};d=a.ViewingService.generateUrl(b,c,d);g.queryParams&&(d=d+"?"+g.queryParams);var h=new XMLHttpRequest;try{var k=function(a){200===h.status?e(h.response?h.response:h.responseText):m(a)},m=function(k){!g.retriedOnce&&
a.ViewingService.shouldRefreshToken(h)?a.ViewingService.refreshToken(function(h){g.retriedOnce=!0;a.ViewingService.get(b,c,d,e,f,g)},function(a){f(h.status,h.statusText,{url:d})}):f(h.status,h.statusText,{url:d})},n=g.hasOwnProperty("asynchronous")?g.asynchronous:!0;h.open("GET",d,n);g.hasOwnProperty("responseType")&&(h.responseType=g.responseType);h.withCredentials=!0;g.hasOwnProperty("withCredentials")&&(h.withCredentials=g.withCredentials);if(g.headers)for(var q in g.headers)h.setRequestHeader(q,
g.headers[q]);n&&(h.onload=k,h.onerror=m,h.ontimeout=m);h.send();a.inWorkerThread?self.postMessage({assetRequest:[d,g.headers,null]}):a.assets.push([d,g.headers,null]);n||k(null)}catch(r){f(h.status,h.statusText,{url:d,exception:r})}}})();
var Xhr=function(){var a=function(a,c,d){this.xhr=new XMLHttpRequest;this.errorHandler=a;this.success=!1;this.viewing_url=d;this.auth=c};a.prototype.generateUrl=function(a,c,d){var e=a.indexOf("urn:");0===e&&this.viewing_url&&((d=d&&d.feature?d.feature:null)?"render"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a)):"bubbles"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a)):"comments"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/file/"+encodeURIComponent(a)):
a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a.substr(e)):a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(e)));c&&(a=a+"?"+c);return a};a.prototype.addHeaders=function(a){for(var c in a)this.xhr.setRequestHeader(c,a[c])};a.prototype.get=function(a,c,d,e,f,g){a=this.generateUrl(a,g,{feature:f});try{this.xhr.open("GET",a,!!e),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),e&&(this.xhr.onload=e),this.addHeaders(c),this.xhr.send()}catch(h){return this.errorHandler&&
this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,200);return this.xhr.response};a.prototype.post=function(a,c,d,e,f,g){a=this.generateUrl(a,null,{feature:g});c["Content-Type"]||(c["Content-Type"]="application/json");try{this.xhr.open("POST",a,!!f),this.xhr.responseType=e,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),f&&(this.xhr.onload=f),this.addHeaders(c),this.xhr.send(d)}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,200,201);
return this.xhr.response};a.prototype.getRange=function(a,c,d,e,f,g){a=this.generateUrl(path);c.Range="bytes="+e+"-"+f;try{this.xhr.open("GET",a,!!g),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),g&&(this.xhr.onload=g),this.addHeaders(c),this.xhr.send()}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,206);return this.xhr.response};a.prototype.head=function(a){a=this.generateUrl(path);try{this.xhr.open("GET",a,!1),this.success=
!1,this.auth&&(this.xhr.withCredentials=!0),this.addHeaders([]),this.xhr.send()}catch(c){return this.errorHandler&&this.errorHandler.networkFailure(a,c),null}this.errorCheck(a,200);a=[];a["Accept-Ranges"]=this.xhr.getResponseHeader("Accept-Ranges");a["Content-Length"]=this.xhr.getResponseHeader("Content-Length");return a};a.prototype.errorCheck=function(a,c){if(4===this.xhr.readyState&&this.xhr.status){var d;for(d=1;d<arguments.length&&this.xhr.status!==arguments[d];d++);d===arguments.length&&this.errorHandler?
this.errorHandler.unsuccessfulResponse(a,this.xhr.status,this.xhr.statusText):this.success=!0}else this.success=!0};return a}(),XhrErrorHandler=function(){var a=function(a){this.host=a;this.ignoreFileNotFound=!1};a.prototype.networkFailure=function(a,c){this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:a,exception:c.toString(),stack:c.stack})};a.prototype.unsuccessfulResponse=function(a,c,d){403==c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,
"Access denied to remote resource",{url:a,httpStatus:c,httpStatusText:d}):404==c?this.ignoreFileNotFound||this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:a,httpStatus:c,httpStatusText:d}):500<=c&&600>c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:a,httpStatus:c,httpStatusText:d}):this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",
{url:a,httpStatus:c,httpStatusText:d})};return a}();
function doGeomLoad(a,b){Autodesk.Viewing.Private.ViewingService.get(b.viewing_url,"items",b.url,function(c){a.postMessage({url:b.url,workerId:b.workerId,progress:.5});try{var d=new PackFileReader(new Uint8Array(c))}catch(e){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading pack file",{url:b.url,exception:e.toString(),stack:e.stack});a.postMessage(null);return}for(var f=c=!1,g={packId:b.packId,meshIndex:0,mesh:null,workerId:b.workerId,progress:0},h=0,k=d.getEntryCounts();h<
k;h++){try{var m=readGeometry(d,h,null)}catch(n){f||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading geometry",{url:b.url,exception:n.toString(),stack:n.stack}),c=f=!0,debug(n.stack)),m=null}g.meshIndex=h;g.mesh=m;g.progress=.5+(h+1)/k*.5;if(m){var q=[];q.push(m.vb.buffer);a.postMessage(g,q)}else c||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unable to load geometry",{url:b.url}),c=!0),a.postMessage(g)}},b.onFailureCallback,{withCredentials:!!b.auth,responseType:"arraybuffer",
asynchronous:!1,headers:b.headers,queryParams:b.queryParams})}function guardFunction(a,b,c){try{c()}catch(d){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while loading SVF",{url:b.url,exception:d.toString(),stack:d.stack}),a.postMessage(null)}}
function doLoadSvfContinued(a,b){guardFunction(a,b,function(){var c=a.svf;b.loadDoneCB=function(d){"svf"==d?a.postMessage({svf:c,progress:.75}):"bvh"==d?(d={nodes:c.bvh.nodes.getRawData(),primitives:c.bvh.primitives,useLeanNodes:32==c.bvh.nodes.bytes_per_node},a.postMessage({bvh:d,basePath:c.basePath,progress:1},[d.nodes,d.primitives.buffer])):"done"==d?a.postMessage({progress:1}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading SVF",{url:b.url}),a.postMessage(null))};a.svf.loadRemainingSvf(b)})}
function doLoadSvf(a,b){Autodesk.Viewing.Private.ViewingService.get(b.viewing_url,"items",b.url,function(c){a.postMessage({progress:.5});guardFunction(a,b,function(){a.svf=new Package(new Uint8Array(c));a.svf.loadManifest(b);b.interceptManifest?a.postMessage({manifest:svf.manifest}):(b.manifest=a.svf.manifest,doLoadSvfContinued(a,b))})},b.onFailureCallback,{withCredentials:!!b.auth,responseType:"arraybuffer",asynchronous:!1,headers:b.headers,queryParams:b.queryParams})}
var propdb=null,propdbFailed=!1,propdbURL="";
function loadPropertyPacks(a,b,c){function d(b){if(!b){if(g){propdbFailed=!0;c(null);return}g=!0;b=[];b.push({filename:"objects_attrs.json",storage:e.attrs});b.push({filename:"objects_vals.json",storage:e.values});b.push({filename:"objects_avs.json",storage:e.avs});b.push({filename:"objects_offs.json",storage:e.offsets});b.push({filename:"objects_ids.json",storage:e.ids});f=b}0===f.length?(propdb=new PropertyDatabase(e),c(propdb),propdbFailed=!1,propdbURL=a.url):(b=f.shift(),requestFile(b.filename,
a,d,b.storage))}if(propdb)c(propdb);else if(propdbFailed)c(null);else if(b=a.propertydb){var e={ids:{},attrs:{},offsets:{},values:{},avs:{}},f=[];f.push({filename:b.attrs.length?b.attrs[0]:"objects_attrs.json.gz",storage:e.attrs});f.push({filename:b.values.length?b.values[0]:"objects_vals.json.gz",storage:e.values});f.push({filename:b.avs.length?b.avs[0]:"objects_avs.json.gz",storage:e.avs});f.push({filename:b.offsets.length?b.offsets[0]:"objects_offs.json.gz",storage:e.offsets});f.push({filename:b.ids.length?
b.ids[0]:"objects_ids.json.gz",storage:e.ids});for(b=0;b<f.length;b++)f[b].filename=f[b].filename.replace(/\\/g,"/");var g=!1;b=f.shift();requestFile(b.filename,a,d,b.storage)}else propdbFailed=!0,c(null)}function doPropertyGet(a,b){var c=b.dbId;loadPropertyPacks(b,c,function(d){d&&(d=d.getObjectProperties(c),a.postMessage({cbId:b.cbId,result:d,dbId:c}))})}
function computeTreeBBoxes(a,b,c){var d=6*a.dbId;b[d]=b[d+1]=b[d+2]=Infinity;b[d+3]=b[d+4]=b[d+5]=-Infinity;var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++){computeTreeBBoxes(e[f],b,c);for(var h=6*(e[f].dbId|0),k=0;3>k;k++)b[d+k]>b[h+k]&&(b[d+k]=b[h+k]),b[d+k+3]<b[h+k+3]&&(b[d+k+3]=b[h+k+3])}if(void 0!==a.fragIds)if(!Array.isArray(a.fragIds))for(e=6*(a.fragIds|0),k=0;3>k;k++)b[d+k]>c[e+k]&&(b[d+k]=c[e+k]),b[d+k+3]<c[e+k+3]&&(b[d+k+3]=c[e+k+3]);else if(a.fragIds.length)for(f=0;f<a.fragIds.length;f++)for(e=
6*(a.fragIds[f]|0),k=0;3>k;k++)b[d+k]>c[e+k]&&(b[d+k]=c[e+k]),b[d+k+3]<c[e+k+3]&&(b[d+k+3]=c[e+k+3])}function buildDbIdToFragMap(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c],f=b[e];void 0===f?b[e]=c:Array.isArray(f)?f.push(c):b[e]=[f,c]}return b}
function doObjectTreeParse(a,b){loadPropertyPacks(b,null,function(c){if(c){var d;b.fragToDbId&&(d=buildDbIdToFragMap(b.fragToDbId));var e=c.findRootNodes(),f,g=[0],h=c.getObjectCount();if(e&&e.length)if(1==e.length)f={dbId:e[0]},c.buildObjectTree(f,d,0,g);else{f={dbId:0,children:[]};for(var k=0;k<e.length;k++){var m={dbId:e[k]};f.children.push(m);c.buildObjectTree(m,d,0,g)}}var n;b.fragBoxes&&(n=new Float32Array(6*c.getObjectCount()),computeTreeBBoxes(f,n,b.fragBoxes));a.postMessage({cbId:b.cbId,
result:{instanceTree:f,instanceBoxes:n,maxTreeDepth:g[0],objectCount:h}})}else a.postMessage({cbId:b.cbId,error:{instanceTree:null,maxTreeDepth:0}})})}
function requestFile(a,b,c,d){var e=b.url+a,f=null,f=-1!==e.indexOf(".gz",e.length-3)?function(b){try{var f=new Uint8Array(b);31==f[0]&&139==f[1]&&(f=(new Zlib.Gunzip(f)).decompress());d[a]=f;c(f)}catch(k){self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:e,exception:k.toString(),stack:k.stack}),c(null)}}:function(b){d[a]=rawbuf;c(new Uint8Array(b))};Autodesk.Viewing.Private.ViewingService.get(b.viewing_url,"items",e,f,function(a,d,e){if(404!==
a)b.onFailureCallback(a,d,e);c(null)},{withCredentials:!!b.auth,responseType:"arraybuffer",asynchronous:!1,headers:b.headers,queryParams:b.queryParams})}function doPropertySearch(a,b){loadPropertyPacks(b,null,function(c){c&&(c=c.bruteForceSearch(b.searchText,b.attributeNames),a.postMessage({cbId:b.cbId,result:c}))})}function doBuildExternalIdMapping(a,b){loadPropertyPacks(b,null,function(c){c&&(c=c.getExternalIdMapping(),a.postMessage({cbId:b.cbId,result:c}))})}
function doParseF2D(a,b){if(b.data){a.postMessage({progress:.5});var c=new F2D(b.metadata,b.manifest,b.basePath,b.f2dLoadOptions);b.loadDoneCB=function(b){b?a.postMessage({f2d:c}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{}),a.postMessage(null))};try{c.load(b,new Uint8Array(b.data))}catch(d){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{exception:d.toString(),stack:d.stack}),a.postMessage(null)}}else a.postMessage(null)}
function doParseF2DFrame(a,b){f2d||(a.postMessage({progress:.5}),f2d=new F2D(b.metadata,b.manifest,b.basePath,b.f2dLoadOptions),f2d.F2D_MESH_COUNT_OLD=0,a.postMessage({f2dframe:f2d}));b.loadDoneCB=function(c){if(c){if(f2d.meshes.length){c={f2dframe:!0,meshes:f2d.meshes,baseIndex:f2d.F2D_MESH_COUNT_OLD,maxObjectNumber:f2d.maxObjectNumber,bbox:f2d.bbox};b.finalFrame&&(c.finalFrame=!0);for(var e=[],f=0,g=f2d.meshes.length;f<g;++f)e.push(f2d.meshes[f].vb.buffer),e.push(f2d.meshes[f].indices.buffer);a.postMessage(c,
e);f2d.F2D_MESH_COUNT_OLD+=f2d.meshes.length;f2d.meshes=[]}}else a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{}),a.postMessage(null)};try{f2d.loadFrames(b)}catch(c){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{exception:c.toString(),stack:c.stack}),a.postMessage(null)}}var ENABLE_F2D_STREAMING_MODE=!0;
function requestFileF2D(a,b){b.errorHandler.ignoreFileNotFound=!0;var c=new Xhr(b.errorHandler,b.auth,b.viewing_url);if(-1!==a.indexOf(".gz",a.length-3)){var d=c.get(a,b.headers,"arraybuffer",null,null,b.queryParams);if(c.success)try{var e=new Uint8Array(d);31==e[0]&&139==e[1]&&(e=(new Zlib.Gunzip(e)).decompress());return e}catch(f){return self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:a,exception:f.toString(),stack:f.stack}),null}else return null}else return d=
c.get(a,b.headers,"arraybuffer"),c.success?new Uint8Array(d):null}
function doStreamF2D(a,b){function c(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);a=decodeURIComponent(escape(b));return JSON.parse(a)}function d(a,b){for(var c=a.length-b,d=new ArrayBuffer(c),e=new Uint8Array(d,0),f=0,g=b;f<c;f++,g++)e[f]=a.charCodeAt(g)&255;return d}var e=b.url;b.queryParams&&(e+="?"+b.queryParams);var f=b.basePath+"metadata.json.gz",g=b.basePath+"manifest.json.gz",h=requestFileF2D(f,b),k=requestFileF2D(g,b),m=[];m.push([g,b.headers,null]);m.push([f,b.headers,
null]);try{h&&(h=c(h)),k&&(k=c(k))}catch(n){k=h=null}if(h){var q;if(k&&k.assets)for(f=k.assets,g=0;g<f.length;g++)if(-1!=e.indexOf(f[g].URI)){q=f[g].usize||0;break}var r=new XMLHttpRequest;r.withCredentials=!!b.auth;var l=new F2DProbe,u=0,t=0,p=!1;r.onreadystatechange=function(){try{if(4==r.readyState){a.postMessage({type:"F2DAssetURL",urls:m});m=null;if(ENABLE_F2D_STREAMING_MODE&&0<t){var c=r.responseText,e={type:"F2DSTREAM",finalFrame:!0,finished:!0,progress:1},f=[];p||(e.manifest=k,e.metadata=
h,e.basePath=b.basePath,p=!0);if(c.length>t){var g=d(c,t),n=new Uint8Array(g),y=l.load(n),z=g.slice(y.frameStart,y.frameEnd);y.frameEnd>y.frameStart&&(f.push(z),e.frames=z)}debug("Total text bytes count : "+r.responseText.length);a.postMessage(e,f);return}c=r.responseText;g=d(c,0);e={type:"F2DBLOB",metadata:h,manifest:k,basePath:b.basePath,progress:1,buffer:g};f=[];f.push(g);a.postMessage(e,f)}if(2<r.readyState&&ENABLE_F2D_STREAMING_MODE&&(c=r.responseText,!(t+65536>c.length))){g=d(c,t);if(!u){++u;
var D=new Uint8Array(g);if(31==D[0]&&139==D[1]){ENABLE_F2D_STREAMING_MODE=!1;return}}n=new Uint8Array(g);y=l.load(n);y.frameEnd>y.frameStart&&(z=g.slice(y.frameStart,y.frameEnd),t+=y.frameEnd,f=[],f.push(z),e={type:"F2DSTREAM",frames:z,finalFrame:!1},q&&(e.progress=t/q),p||(e.manifest=k,e.metadata=h,e.basePath=b.basePath,p=!0),a.postMessage(e,f))}}catch(v){debug(v.message)}};try{r.open("GET",e,!0);if(b.headers)for(var y in b.headers)r.setRequestHeader(y,b.headers[y]);r.overrideMimeType("text/plain; charset=x-user-defined");
r.send();m.push([e,b.headers,null])}catch(z){debug(z.message)}}else self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"")}AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,RTC_ERROR:11};
var ENABLE_OCTM_MG2=!1,IS_WORKER="undefined"!==typeof self&&"undefined"===typeof window;
if(IS_WORKER){var debug=function(a){self.postMessage({debug:1,message:a})},f2d=null;IS_CONCAT_BUILD||(importScripts("../AutodeskNamespace.js"),importScripts("../compatibility.js"),importScripts("../../thirdparty/three.js/LmvMatrix4.js"),importScripts("../lmvtk/gunzip.min.js"),importScripts("../lmvtk/unzip.min.js"),ENABLE_OCTM_MG2&&(importScripts("../lmvtk/inflate.min.js"),importScripts("../lmvtk/octm_mg2.js")),importScripts("../lmvtk/BVHBuilder.js"),importScripts("../lmvtk/InputStream.js"),importScripts("../lmvtk/VbUtils.js"),
importScripts("../lmvtk/VertexBufferBuilder.js"),importScripts("../lmvtk/PackReader.js"),importScripts("../lmvtk/Geoms.js"),importScripts("../lmvtk/Materials.js"),importScripts("../lmvtk/Lights.js"),importScripts("../lmvtk/Cameras.js"),importScripts("../lmvtk/Fragments.js"),importScripts("../lmvtk/Instances.js"),importScripts("../lmvtk/Package.js"),importScripts("../lmvtk/PackReader.js"),importScripts("../lmvtk/Propdb.js"),importScripts("../lmvtk/F2d.js"),importScripts("../lmvtk/F2dProbe.js"),importScripts("../lmvtk/CheckedInputStream.js"),
importScripts("../net/Xhr.js"),importScripts("GeomWorker.js"),importScripts("SvfWorker.js"),importScripts("PropWorker.js"),importScripts("F2dParseWorker.js"),importScripts("F2dStreamWorker.js"),importScripts("../ErrorCodes.js"));self.addEventListener("message",function(a){var b=a.data;if(b.hasOwnProperty("operation")){b.basePath="";if(b.url){var c=b.url.lastIndexOf("/");-1!=c&&(b.basePath=b.url.substr(0,c+1))}b.onFailureCallback=function(a,b,c){403==a?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,
"Access denied to remote resource",{url:c.url,httpStatus:a,httpStatusText:b}):404==a?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:c.url,httpStatus:a,httpStatusText:b}):500<=a&&600>a?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:c.url,httpStatus:a,httpStatusText:b}):c.exception?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:c.url,exception:c.exception.toString(),
stack:c.exception.stack}):self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:c.url,httpStatus:a,httpStatusText:b})};b.errorHandler=new XhrErrorHandler(self);a=a.data.operation;"LOAD_GEOMETRY"==a?doGeomLoad(self,b):"LOAD_SVF"==a?doLoadSvf(self,b):"LOAD_SVF_CONTD"==a?doLoadSvfContinued(self,b):"GET_PROPERTIES"==a?doPropertyGet(self,b):"SEARCH_PROPERTIES"==a?doPropertySearch(self,b):"BUILD_EXTERNAL_ID_MAPPING"==a?doBuildExternalIdMapping(self,
b):"GET_OBJECT_TREE"==a?doObjectTreeParse(self,b):"PARSE_F2D"==a?doParseF2D(self,b):"PARSE_F2D_FRAME"==a?doParseF2DFrame(self,b):"STREAM_F2D"==a&&doStreamF2D(self,b)}},!1);self.raiseError=function(a,b,c){self.postMessage({error:{code:a,msg:b,args:c}})}};
